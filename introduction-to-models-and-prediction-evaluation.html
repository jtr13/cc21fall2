<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 67 Introduction to models and prediction evaluation | EDAV Fall 2021 Tues/Thurs Community Contributions</title>
<meta name="description" content="Yi Duan library(ISLR) library(dplyr) library(pROC) library(tree) library(rpart) library(randomForest) In this introduction, we will introduce the profit model, logit model and tree models....">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 67 Introduction to models and prediction evaluation | EDAV Fall 2021 Tues/Thurs Community Contributions">
<meta property="og:type" content="book">
<meta property="og:description" content="Yi Duan library(ISLR) library(dplyr) library(pROC) library(tree) library(rpart) library(randomForest) In this introduction, we will introduce the profit model, logit model and tree models....">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 67 Introduction to models and prediction evaluation | EDAV Fall 2021 Tues/Thurs Community Contributions">
<meta name="twitter:description" content="Yi Duan library(ISLR) library(dplyr) library(pROC) library(tree) library(rpart) library(randomForest) In this introduction, we will introduce the profit model, logit model and tree models....">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/forceNetwork-binding-0.4/forceNetwork.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="libs/vis-9.1.0/vis-network.min.js"></script><script src="libs/visNetwork-binding-2.1.0/visNetwork.js"></script><link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet">
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script><script src="libs/dygraphs-1.1.1/shapes.js"></script><script src="libs/moment-2.8.4/moment.js"></script><script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script><script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script><script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script><script src="libs/proj4js-2.3.15/proj4.js"></script><link href="libs/highcharts-8.1.2/css/motion.css" rel="stylesheet">
<script src="libs/highcharts-8.1.2/highcharts.js"></script><script src="libs/highcharts-8.1.2/highcharts-3d.js"></script><script src="libs/highcharts-8.1.2/highcharts-more.js"></script><script src="libs/highcharts-8.1.2/modules/stock.js"></script><script src="libs/highcharts-8.1.2/modules/map.js"></script><script src="libs/highcharts-8.1.2/modules/annotations.js"></script><script src="libs/highcharts-8.1.2/modules/data.js"></script><script src="libs/highcharts-8.1.2/modules/drilldown.js"></script><script src="libs/highcharts-8.1.2/modules/item-series.js"></script><script src="libs/highcharts-8.1.2/modules/offline-exporting.js"></script><script src="libs/highcharts-8.1.2/modules/overlapping-datalabels.js"></script><script src="libs/highcharts-8.1.2/modules/exporting.js"></script><script src="libs/highcharts-8.1.2/modules/export-data.js"></script><script src="libs/highcharts-8.1.2/modules/funnel.js"></script><script src="libs/highcharts-8.1.2/modules/heatmap.js"></script><script src="libs/highcharts-8.1.2/modules/treemap.js"></script><script src="libs/highcharts-8.1.2/modules/sankey.js"></script><script src="libs/highcharts-8.1.2/modules/dependency-wheel.js"></script><script src="libs/highcharts-8.1.2/modules/organization.js"></script><script src="libs/highcharts-8.1.2/modules/solid-gauge.js"></script><script src="libs/highcharts-8.1.2/modules/streamgraph.js"></script><script src="libs/highcharts-8.1.2/modules/sunburst.js"></script><script src="libs/highcharts-8.1.2/modules/vector.js"></script><script src="libs/highcharts-8.1.2/modules/wordcloud.js"></script><script src="libs/highcharts-8.1.2/modules/xrange.js"></script><script src="libs/highcharts-8.1.2/modules/tilemap.js"></script><script src="libs/highcharts-8.1.2/modules/venn.js"></script><script src="libs/highcharts-8.1.2/modules/gantt.js"></script><script src="libs/highcharts-8.1.2/modules/timeline.js"></script><script src="libs/highcharts-8.1.2/modules/parallel-coordinates.js"></script><script src="libs/highcharts-8.1.2/modules/bullet.js"></script><script src="libs/highcharts-8.1.2/modules/coloraxis.js"></script><script src="libs/highcharts-8.1.2/modules/dumbbell.js"></script><script src="libs/highcharts-8.1.2/modules/lollipop.js"></script><script src="libs/highcharts-8.1.2/modules/series-label.js"></script><script src="libs/highcharts-8.1.2/plugins/motion.js"></script><script src="libs/highcharts-8.1.2/custom/reset.js"></script><script src="libs/highcharts-8.1.2/modules/boost.js"></script><script src="libs/highchart-binding-0.8.2/highchart.js"></script><script src="libs/detect-resize-0.5.3/jquery.resize.js"></script><link href="libs/jquery-ui-1.11.4/jquery-ui.min.css" rel="stylesheet">
<script src="libs/jquery-ui-1.11.4/jquery-ui.min.js"></script><script src="libs/vega-1.4.3/vega.min.js"></script><script src="libs/lodash-2.2.1/lodash.min.js"></script><script>var lodash = _.noConflict();</script><link href="libs/ggvis-0.4.7/css/ggvis.css" rel="stylesheet">
<script src="libs/ggvis-0.4.7/js/ggvis.js"></script><link href="libs/wordcloud2-0.0.1/wordcloud.css" rel="stylesheet">
<script src="libs/wordcloud2-0.0.1/wordcloud2-all.js"></script><script src="libs/wordcloud2-0.0.1/hover.js"></script><script src="libs/wordcloud2-binding-0.2.1/wordcloud2.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">EDAV Fall 2021 Tues/Thurs Community Contributions</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome!</a></li>
<li><a class="" href="community-contribution.html"><span class="header-section-number">2</span> Community Contribution</a></li>
<li><a class="" href="github-submission-instructions.html"><span class="header-section-number">3</span> GitHub submission instructions</a></li>
<li><a class="" href="sample-project.html"><span class="header-section-number">4</span> Sample project</a></li>
<li class="book-part">Cheatsheets</li>
<li><a class="" href="statistics-in-r-vs-python.html"><span class="header-section-number">5</span> Statistics in R vs Python</a></li>
<li><a class="" href="data-visualization-with-seaborn.html"><span class="header-section-number">6</span> Data Visualization with Seaborn</a></li>
<li><a class="" href="how-to-make-your-own-r-package.html"><span class="header-section-number">7</span> How to Make Your Own R package</a></li>
<li><a class="" href="rchess-package-cheatsheet.html"><span class="header-section-number">8</span> RChess package cheatsheet</a></li>
<li><a class="" href="hypothesis-testing-cheatsheet.html"><span class="header-section-number">9</span> Hypothesis testing cheatsheet</a></li>
<li><a class="" href="interactive-web-visualizations-for-r-cheatsheet.html"><span class="header-section-number">10</span> Interactive web visualizations for R cheatsheet"</a></li>
<li><a class="" href="ggforce.html"><span class="header-section-number">11</span> ggforce</a></li>
<li><a class="" href="gganimate-cheatsheet.html"><span class="header-section-number">12</span> GGanimate cheatsheet</a></li>
<li><a class="" href="statistical-tests-and-parameter-estimations-in-r-cheatsheet.html"><span class="header-section-number">13</span> Statistical Tests and Parameter Estimations in R Cheatsheet</a></li>
<li><a class="" href="ggalluvial-cheat-sheet.html"><span class="header-section-number">14</span> ggalluvial-cheat-sheet</a></li>
<li><a class="" href="introduction-to-plotly.html"><span class="header-section-number">15</span> Introduction to plotly</a></li>
<li><a class="" href="draw-graphs-using-python-and-r.html"><span class="header-section-number">16</span> draw graphs using python and R</a></li>
<li><a class="" href="data-visualization-packages-in-r.html"><span class="header-section-number">17</span> Data Visualization Packages in R</a></li>
<li><a class="" href="esquisse-cheat-sheet.html"><span class="header-section-number">18</span> Esquisse Cheat sheet</a></li>
<li><a class="" href="review-sheet-for-r-code-and-data-transformation.html"><span class="header-section-number">19</span> review sheet for r code and data transformation</a></li>
<li><a class="" href="scrape-twitter-data-using-r.html"><span class="header-section-number">20</span> Scrape Twitter data using R</a></li>
<li><a class="" href="r-note-and-mathematics-in-rmd-cheatsheet.html"><span class="header-section-number">21</span> R note and Mathematics in Rmd cheatsheet</a></li>
<li><a class="" href="textbook-notes.html"><span class="header-section-number">22</span> Textbook Notes</a></li>
<li><a class="" href="ggplot2-cheatsheet.html"><span class="header-section-number">23</span> ggplot2 cheatsheet</a></li>
<li><a class="" href="rstudio-cheatsheet.html"><span class="header-section-number">24</span> RStudio Cheatsheet</a></li>
<li><a class="" href="d3-visualization-in-r-cheatsheet.html"><span class="header-section-number">25</span> D3 Visualization in R Cheatsheet</a></li>
<li><a class="" href="colors.html"><span class="header-section-number">26</span> Colors</a></li>
<li><a class="" href="r-data-sets.html"><span class="header-section-number">27</span> R data sets</a></li>
<li><a class="" href="introduction-to-plotly-1.html"><span class="header-section-number">28</span> “Introduction to Plotly”</a></li>
<li><a class="" href="tidyverse-cheatsheet.html"><span class="header-section-number">29</span> Tidyverse Cheatsheet</a></li>
<li><a class="" href="learning-sql-with-its-r-dplyr-translation.html"><span class="header-section-number">30</span> Learning SQL with Its R dplyr Translation</a></li>
<li><a class="" href="animate-time-series-the-goyav-package.html"><span class="header-section-number">31</span> Animate Time Series : the goyav package</a></li>
<li><a class="" href="string-manipulation-in-r.html"><span class="header-section-number">32</span> String Manipulation in R</a></li>
<li><a class="" href="ggalluvial-cheatsheet.html"><span class="header-section-number">33</span> ggalluvial Cheatsheet</a></li>
<li><a class="" href="a-cheatsheet-from-pandas-to-base-r-and-tidyverse.html"><span class="header-section-number">34</span> A cheatsheet from pandas to base r and tidyverse</a></li>
<li><a class="" href="base-r-ggplot2-python-graphing-performances.html"><span class="header-section-number">35</span> Base R, ggplot2, &amp; Python Graphing Performances</a></li>
<li><a class="" href="cheat-sheet-to-score-100-points.html"><span class="header-section-number">36</span> Cheat Sheet to Score 100 Points</a></li>
<li><a class="" href="base-r-string-operations-cheatsheet.html"><span class="header-section-number">37</span> Base R String Operations Cheatsheet</a></li>
<li><a class="" href="data-manipulation-in-r.html"><span class="header-section-number">38</span> Data manipulation in R</a></li>
<li><a class="" href="ggplot_matplotlib_cheatsheet.html"><span class="header-section-number">39</span> ggplot_matplotlib_cheatsheet</a></li>
<li><a class="" href="introduction-to-log-transformation.html"><span class="header-section-number">40</span> Introduction to Log-transformation</a></li>
<li class="book-part">Tutorials</li>
<li><a class="" href="how-to-integrate-r-with-postgresql.html"><span class="header-section-number">41</span> How to Integrate R with PostgreSQL</a></li>
<li><a class="" href="tutorial-on-cluster-analysis.html"><span class="header-section-number">42</span> Tutorial on Cluster Analysis</a></li>
<li><a class="" href="apply-function-in-r.html"><span class="header-section-number">43</span> Apply function in r</a></li>
<li><a class="" href="introduction-to-interactive-graphs-in-r.html"><span class="header-section-number">44</span> Introduction to interactive graphs in R</a></li>
<li><a class="" href="plot-and-analyze-stock-data-with-r.html"><span class="header-section-number">45</span> Plot and Analyze Stock Data with R</a></li>
<li><a class="" href="data-visulization-ordering.html"><span class="header-section-number">46</span> Data Visulization Ordering</a></li>
<li><a class="" href="tutorial-on-lattice-package-in-r.html"><span class="header-section-number">47</span> Tutorial on lattice package in R</a></li>
<li><a class="" href="network-visualization-in-r.html"><span class="header-section-number">48</span> Network Visualization in R</a></li>
<li><a class="" href="dplyr-tutorial-in-r.html"><span class="header-section-number">49</span> Dplyr tutorial in R</a></li>
<li><a class="" href="downloading-files.html"><span class="header-section-number">50</span> Downloading files</a></li>
<li><a class="" href="video-introduction-to-maps-with-ggmap.html"><span class="header-section-number">51</span> Video introduction to maps with ggmap</a></li>
<li><a class="" href="comparison-among-base-r-tidyverse-and-datatable.html"><span class="header-section-number">52</span> Comparison among base R, tidyverse, and datatable</a></li>
<li><a class="" href="raincloud-plot-101-density-plot-or-boxplotwhy-not-do-both.html"><span class="header-section-number">53</span> Raincloud plot 101: density plot or boxplot？Why not do both!</a></li>
<li><a class="" href="an-introduction-to-dygraph-in-r.html"><span class="header-section-number">54</span> An Introduction to Dygraph in R</a></li>
<li><a class="" href="streamlit-tutorial.html"><span class="header-section-number">55</span> Streamlit Tutorial</a></li>
<li><a class="" href="hive-plots-with-the-ggraph-and-hiver-packages.html"><span class="header-section-number">56</span> Hive plots with the ggraph and hiver packages</a></li>
<li><a class="" href="introduction-to-xai-explainable-ai-in-r.html"><span class="header-section-number">57</span> Introduction to XAI (Explainable AI) in R</a></li>
<li><a class="" href="tutorial-for-gg_cleveland.html"><span class="header-section-number">58</span> Tutorial for gg_cleveland</a></li>
<li><a class="" href="neural-network-tools-in-r.html"><span class="header-section-number">59</span> Neural network tools in R</a></li>
<li><a class="" href="r-dplyr-vs-python-pandas.html"><span class="header-section-number">60</span> R Dplyr vs Python Pandas</a></li>
<li><a class="" href="readable-plots.html"><span class="header-section-number">61</span> Readable Plots</a></li>
<li><a class="" href="introduction-to-exploratory-spatial-data-analysis-and-visualization-using-qgis.html"><span class="header-section-number">62</span> Introduction to exploratory spatial data analysis and visualization using QGIS</a></li>
<li><a class="" href="data-visualization-in-python-vs-r.html"><span class="header-section-number">63</span> Data Visualization in Python vs R</a></li>
<li><a class="" href="base-r-tutorial.html"><span class="header-section-number">64</span> Base R Tutorial</a></li>
<li><a class="" href="python-altair-visualization-method-tutorial.html"><span class="header-section-number">65</span> Python Altair Visualization Method Tutorial</a></li>
<li><a class="" href="r-to-python-easy-plot.html"><span class="header-section-number">66</span> R to python easy plot</a></li>
<li><a class="active" href="introduction-to-models-and-prediction-evaluation.html"><span class="header-section-number">67</span> Introduction to models and prediction evaluation</a></li>
<li><a class="" href="introduction-to-interactive-time-series-visualizations-with-dygraphs-in-r.html"><span class="header-section-number">68</span> Introduction to Interactive Time Series Visualizations with dygraphs in R</a></li>
<li><a class="" href="integrate-r-with-python.html"><span class="header-section-number">69</span> Integrate R with Python</a></li>
<li><a class="" href="python-visualization-tutorial.html"><span class="header-section-number">70</span> Python Visualization Tutorial</a></li>
<li><a class="" href="gganimate-tutorial.html"><span class="header-section-number">71</span> Gganimate Tutorial</a></li>
<li><a class="" href="get-nba-dataset-in-r.html"><span class="header-section-number">72</span> Get NBA dataset in R</a></li>
<li><a class="" href="mtemplates.html"><span class="header-section-number">73</span> Mtemplates</a></li>
<li><a class="" href="introduction-to-time-series-analysis-in-r.html"><span class="header-section-number">74</span> Introduction to Time Series Analysis in R</a></li>
<li><a class="" href="storytelling-with-data.html"><span class="header-section-number">75</span> Storytelling with Data</a></li>
<li><a class="" href="tutorial-on-r-torch-package.html"><span class="header-section-number">76</span> Tutorial on R torch package</a></li>
<li><a class="" href="edav-tutorials-correlogram-calendar-heatmap-and-slopegram.html"><span class="header-section-number">77</span> EDAV Tutorials: Correlogram, Calendar Heatmap and Slopegram</a></li>
<li><a class="" href="recursive-codes-and-self-organized-map-with-r.html"><span class="header-section-number">78</span> Recursive codes and self-organized map with R</a></li>
<li><a class="" href="tutorial-of-three-ggplot2-based-packages.html"><span class="header-section-number">79</span> Tutorial of three ggplot2 based packages</a></li>
<li><a class="" href="a-step-by-step-tutorial-for-natural-language-processing-in-r.html"><span class="header-section-number">80</span> A Step by Step Tutorial for Natural Language Processing in R</a></li>
<li><a class="" href="tutorial-for-ggvis-and-its-comparison-with-ggplot2.html"><span class="header-section-number">81</span> Tutorial for ggvis and its Comparison with ggplot2</a></li>
<li><a class="" href="feature-selection-in-r.html"><span class="header-section-number">82</span> Feature selection in r</a></li>
<li><a class="" href="debugging-in-rstudio.html"><span class="header-section-number">83</span> Debugging in Rstudio</a></li>
<li><a class="" href="r-tutorial-cheatsheet.html"><span class="header-section-number">84</span> R tutorial cheatsheet</a></li>
<li><a class="" href="brief-introduction-of-ggpubr.html"><span class="header-section-number">85</span> Brief Introduction of ggpubr</a></li>
<li><a class="" href="r-based-data-organization-and-visualization.html"><span class="header-section-number">86</span> R based data organization and visualization</a></li>
<li><a class="" href="r-packages-for-map-visualization.html"><span class="header-section-number">87</span> R packages for map Visualization</a></li>
<li><a class="" href="common-git-command-lines-tutorial-when-working-on-studio.html"><span class="header-section-number">88</span> Common git command lines tutorial when working on studio</a></li>
<li><a class="" href="tutorial-of-radar-chart.html"><span class="header-section-number">89</span> Tutorial of radar chart</a></li>
<li><a class="" href="interactive-radar.html"><span class="header-section-number">90</span> Interactive Radar</a></li>
<li><a class="" href="r-shiny-tutorial.html"><span class="header-section-number">91</span> R shiny tutorial</a></li>
<li><a class="" href="tutorial-on-r-markdown.html"><span class="header-section-number">92</span> Tutorial on R Markdown</a></li>
<li><a class="" href="dlookr-package.html"><span class="header-section-number">93</span> Dlookr package</a></li>
<li><a class="" href="urca-unit-root-test-and-cointegration-test.html"><span class="header-section-number">94</span> Urca: Unit Root Test and Cointegration Test</a></li>
<li><a class="" href="pygal-tutorial.html"><span class="header-section-number">95</span> pygal tutorial</a></li>
<li><a class="" href="comparing-excel-chart-making-with-rs.html"><span class="header-section-number">96</span> Comparing Excel Chart Making with R’s</a></li>
<li><a class="" href="joining-and-reshaping-in-r.html"><span class="header-section-number">97</span> Joining and reshaping in R</a></li>
<li><a class="" href="running-sql-queries-on-dataframes.html"><span class="header-section-number">98</span> Running Sql Queries on Dataframes</a></li>
<li><a class="" href="tidyverse.html"><span class="header-section-number">99</span> TidyVerse</a></li>
<li><a class="" href="how-to-animate-your-plots.html"><span class="header-section-number">100</span> How to animate your plots</a></li>
<li><a class="" href="dataframe-operations-tutorial.html"><span class="header-section-number">101</span> Dataframe operations tutorial</a></li>
<li><a class="" href="a-brief-instruction-for-the-half-semester-of-edav5702.html"><span class="header-section-number">102</span> A brief instruction for the half semester of EDAV5702</a></li>
<li><a class="" href="anova-tutorial.html"><span class="header-section-number">103</span> ANOVA tutorial</a></li>
<li><a class="" href="ggplot2-in-python.html"><span class="header-section-number">104</span> ggplot2 in python</a></li>
<li><a class="" href="predictive-analytics-using-data-visualization-in-r.html"><span class="header-section-number">105</span> Predictive Analytics using Data Visualization in R</a></li>
<li><a class="" href="color-selection-for-ggplot-graphs.html"><span class="header-section-number">106</span> Color selection for ggplot graphs</a></li>
<li><a class="" href="useful-resources-for-r-beginners.html"><span class="header-section-number">107</span> Useful resources for R beginners</a></li>
<li><a class="" href="tutorial-on-using-mongodb-with-r.html"><span class="header-section-number">108</span> Tutorial on Using MongoDB with R</a></li>
<li><a class="" href="plotting-graph-with-r-v.s.-python.html"><span class="header-section-number">109</span> Plotting graph with R v.s. Python</a></li>
<li><a class="" href="rdoc---an-alfred-worflow-to-search-r-documentation.html"><span class="header-section-number">110</span> rdoc - An Alfred Worflow to Search R Documentation</a></li>
<li><a class="" href="data-frame-reshape.html"><span class="header-section-number">111</span> Data Frame Reshape</a></li>
<li class="book-part">Project &amp; Workshops</li>
<li><a class="" href="introduction-to-analytics-consulting-at-accenture.html"><span class="header-section-number">112</span> Introduction to analytics consulting at Accenture</a></li>
<li><a class="" href="map-of-the-r-world.html"><span class="header-section-number">113</span> Map of the R world</a></li>
<li><a class="" href="alluvial-diagrams-and-their-implementation-using-ggalluvial-in-r.html"><span class="header-section-number">114</span> Alluvial diagrams and their implementation using GGalluvial in R</a></li>
<li><a class="" href="building-a-dashboard-in-r-for-data-analysis-and-visualization-using-shiny-package.html"><span class="header-section-number">115</span> Building a Dashboard in R for Data Analysis and Visualization using shiny package</a></li>
<li><a class="" href="rgl-package.html"><span class="header-section-number">116</span> RGL Package</a></li>
<li class="book-part">Data Visualization</li>
<li><a class="" href="an-introduction-to-pyecharts-package-in-python.html"><span class="header-section-number">117</span> An introduction to pyecharts package in Python</a></li>
<li><a class="" href="visualization-in-r-v.s.-python.html"><span class="header-section-number">118</span> Visualization in R v.s. Python</a></li>
<li><a class="" href="understand-data-with-plots.html"><span class="header-section-number">119</span> Understand data with plots</a></li>
<li><a class="" href="r-and-python-visualization.html"><span class="header-section-number">120</span> R and Python visualization</a></li>
<li><a class="" href="d-visualization-with-rgl-and-scatterplot3d.html"><span class="header-section-number">121</span> 3D Visualization with rgl and scatterplot3d</a></li>
<li><a class="" href="base-r-vs.-ggplot2-visualization.html"><span class="header-section-number">122</span> Base r vs. ggplot2 visualization</a></li>
<li><a class="" href="improved-density-estimation.html"><span class="header-section-number">123</span> Improved density estimation</a></li>
<li><a class="" href="plotting-theme-for-columbia.html"><span class="header-section-number">124</span> Plotting theme for Columbia</a></li>
<li class="book-part">Custom R Package</li>
<li><a class="" href="super-ggformat.html"><span class="header-section-number">125</span> Super ggformat</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="github-initial-setup.html"><span class="header-section-number">126</span> Github initial setup</a></li>
<li><a class="" href="tutorial-for-pull-request-mergers.html"><span class="header-section-number">127</span> Tutorial for pull request mergers</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/jtr13/cc21fall2">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="introduction-to-models-and-prediction-evaluation" class="section level1">
<h1>
<span class="header-section-number">67</span> Introduction to models and prediction evaluation<a class="anchor" aria-label="anchor" href="#introduction-to-models-and-prediction-evaluation"><i class="fas fa-link"></i></a>
</h1>
<p>Yi Duan</p>
<div class="sourceCode" id="cb871"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.statlearning.com">ISLR</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://expasy.org/tools/pROC/">pROC</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bethatkinson/rpart">rpart</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">randomForest</a></span><span class="op">)</span></code></pre></div>
<p>In this introduction, we will introduce the profit model, logit model and tree models. Moreover, we will use a specific example to show how they are used in R. To compare these models, we will introduce ROC to evaluate their predictions in the example.</p>
<div id="models-for-binomial-data" class="section level2">
<h2>
<span class="header-section-number">67.1</span> Models for binomial data<a class="anchor" aria-label="anchor" href="#models-for-binomial-data"><i class="fas fa-link"></i></a>
</h2>
<div id="profit-model" class="section level3">
<h3>
<span class="header-section-number">67.1.1</span> Profit model<a class="anchor" aria-label="anchor" href="#profit-model"><i class="fas fa-link"></i></a>
</h3>
<p>In statistics, a probit model is a type of regression where the dependent variable can take only two values. The word is a portmanteau, coming from probability + unit. The purpose of the model is to estimate the probability that an observation with particular characteristics will fall into a specific one of the categories; moreover, classifying observations based on their predicted probabilities is a type of binary classification model.</p>
<p>A probit model is a popular specification for a binary response model. As such it treats the same set of problems as does logistic regression using similar techniques. When viewed in the generalized linear model framework, the probit model employs a probit link function. It is most often estimated using the maximum likelihood procedure, such an estimation being called a probit regression.</p>
<p>There is an underlying mechanism, there is a variable y, that is distributed normally (denoted <span class="math inline">\(\phi\)</span>()). When y is greater than a threshold, we get an observation. The probability changes because the mean <span class="math inline">\(\mu\)</span> is a linear function of the conditioning variables =x’<span class="math inline">\(\beta\)</span>.</p>
</div>
<div id="logit-model" class="section level3">
<h3>
<span class="header-section-number">67.1.2</span> Logit model<a class="anchor" aria-label="anchor" href="#logit-model"><i class="fas fa-link"></i></a>
</h3>
<p>In statistics, the logistic model (or logit model) is used to model the probability of a certain class or event existing such as pass/fail, win/lose, alive/dead or healthy/sick. This can be extended to model several classes of events such as determining whether an image contains a cat, dog, lion, etc. Each object being detected in the image would be assigned a probability between 0 and 1, with a sum of one.</p>
<p>Logistic regression is a statistical model that in its basic form uses a logistic function to model a binary dependent variable, although many more complex extensions exist. In regression analysis, logistic regression is estimating the parameters of a logistic model (a form of binary regression). Mathematically, a binary logistic model has a dependent variable with two possible values, such as pass/fail which is represented by an indicator variable, where the two values are labeled “0” and “1”. In the logistic model, the log-odds (the logarithm of the odds) for the value labeled “1” is a linear combination of one or more independent variables (“predictors”); the independent variables can each be a binary variable (two classes, coded by an indicator variable) or a continuous variable (any real value). The defining characteristic of the logistic model is that increasing one of the independent variables multiplicatively scales the odds of the given outcome at a constant rate, with each independent variable having its own parameter; for a binary dependent variable this generalizes the odds ratio.</p>
<p>The log odds is a linear function of the conditioning variables, ln(p/(1-p)) =x’<span class="math inline">\(\beta\)</span><br>
So p=exp(x’<span class="math inline">\(\beta\)</span>)/(1+exp(x’<span class="math inline">\(\beta\)</span>))<br></p>
</div>
<div id="how-to-fit-these-and-choose-models" class="section level3">
<h3>
<span class="header-section-number">67.1.3</span> How to fit these and choose models<a class="anchor" aria-label="anchor" href="#how-to-fit-these-and-choose-models"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Likelihood<br><ul>
<li>The product of the densities (or probability mass function) evaluated at the data<br>
</li>
<li>
<span class="math inline">\(L(x)=f(x_1)f(x_2)...f(x_n)=\prod_{i=1}^{n} f(x_i)\)</span><br>
</li>
<li>We want to maximize this.<br>
</li>
</ul>
</li>
<li>Log likelihood works better<br><ul>
<li>
<span class="math inline">\(l(x)=ln(f(x_1)f(x_2)...f(x_n))=\sum_{i=1}^{n} ln(f(x_i))\)</span><br>
</li>
</ul>
</li>
<li>If f is contained in g<br>
</li>
<li>2*ln(L(x|f)/L(x|g))~<span class="math inline">\(\chi^2_{n(g)-n(f)}\)</span>, n(f)= number of parameters in f. This is like sums of squares, just need a base likelihood g. The package glm, provides this. And for nested models we can compare likelihood differences.<br>
</li>
<li>Deviance(2(ln(x,f)-ln(x,x)) allows direct comparison between models.<br>
</li>
</ul>
</div>
<div id="we-will-use-glm-to-fit-and-analyze-models" class="section level3">
<h3>
<span class="header-section-number">67.1.4</span> We will use GLM to fit and analyze models<a class="anchor" aria-label="anchor" href="#we-will-use-glm-to-fit-and-analyze-models"><i class="fas fa-link"></i></a>
</h3>
<p>GLM is used to fit generalized linear models, specified by giving a symbolic description of the linear predictor and a description of the error distribution. Family objects provide a convenient way to specify the details of the models used by functions such as glm. Link is a specification for the model link function.<br></p>
<p>Let’s take a look at the Default data first.<br></p>
<div class="sourceCode" id="cb872"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Default</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span></code></pre></div>
<pre><code>##   default student   balance   income
## 1      No      No  729.5265 44361.63
## 2      No     Yes  817.1804 12106.13
## 3      No      No 1073.5492 31767.14</code></pre>
<p>Student or non-student status may have a very significant effect, so we can model the effects on default of balance and income.<br>
1. For all the data<br>
2. Separately for the student and the non-student data<br></p>
<p><strong>Logit Model</strong></p>
<p>To use the logit model, we need to set family to binomial and link to logit.<br></p>
<div class="sourceCode" id="cb874"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Default.logit.out</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">default</span><span class="op">~</span><span class="va">balance</span><span class="op">+</span><span class="va">income</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link<span class="op">=</span><span class="va">logit</span><span class="op">)</span>,<span class="va">Default</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Default.logit.out</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = default ~ balance + income, family = binomial(link = logit), 
##     data = Default)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.4725  -0.1444  -0.0574  -0.0211   3.7245  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.154e+01  4.348e-01 -26.545  &lt; 2e-16 ***
## balance      5.647e-03  2.274e-04  24.836  &lt; 2e-16 ***
## income       2.081e-05  4.985e-06   4.174 2.99e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2920.6  on 9999  degrees of freedom
## Residual deviance: 1579.0  on 9997  degrees of freedom
## AIC: 1585
## 
## Number of Fisher Scoring iterations: 8</code></pre>
<p><strong>Logit, just students</strong></p>
<div class="sourceCode" id="cb876"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Student.Default</span><span class="op">&lt;-</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Default</span>,<span class="va">student</span><span class="op">==</span><span class="st">"Yes"</span><span class="op">)</span>
<span class="va">Default.logit.out.stu</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">default</span><span class="op">~</span><span class="va">balance</span><span class="op">+</span><span class="va">income</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link<span class="op">=</span><span class="va">logit</span><span class="op">)</span>,<span class="va">Student.Default</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Default.logit.out.stu</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = default ~ balance + income, family = binomial(link = logit), 
##     data = Student.Default)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.1244  -0.1674  -0.0691  -0.0265   3.3252  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.151e+01  8.107e-01 -14.194   &lt;2e-16 ***
## balance      5.598e-03  3.774e-04  14.832   &lt;2e-16 ***
## income       1.585e-05  2.610e-05   0.607    0.544    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1046.85  on 2943  degrees of freedom
## Residual deviance:  563.03  on 2941  degrees of freedom
## AIC: 569.03
## 
## Number of Fisher Scoring iterations: 8</code></pre>
<p><strong>Logit, no students</strong></p>
<div class="sourceCode" id="cb878"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NonStudent.Default</span><span class="op">&lt;-</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Default</span>,<span class="va">student</span><span class="op">==</span><span class="st">"No"</span><span class="op">)</span>
<span class="va">Default.logit.out.nstu</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">default</span><span class="op">~</span><span class="va">balance</span><span class="op">+</span><span class="va">income</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link<span class="op">=</span><span class="va">logit</span><span class="op">)</span>,<span class="va">NonStudent.Default</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Default.logit.out.nstu</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = default ~ balance + income, family = binomial(link = logit), 
##     data = NonStudent.Default)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.4897  -0.1316  -0.0502  -0.0181   3.7600  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.094e+01  5.752e-01 -19.015   &lt;2e-16 ***
## balance      5.818e-03  2.938e-04  19.803   &lt;2e-16 ***
## income       1.597e-06  8.670e-06   0.184    0.854    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1861.8  on 7055  degrees of freedom
## Residual deviance: 1008.0  on 7053  degrees of freedom
## AIC: 1014
## 
## Number of Fisher Scoring iterations: 8</code></pre>
<p><strong>Modeling student</strong></p>
<div class="sourceCode" id="cb880"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Default.logit.out.allvar</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">default</span><span class="op">~</span><span class="va">balance</span><span class="op">+</span><span class="va">income</span><span class="op">+</span><span class="va">student</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link<span class="op">=</span><span class="va">logit</span><span class="op">)</span>,<span class="va">Default</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Default.logit.out.allvar</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = default ~ balance + income + student, family = binomial(link = logit), 
##     data = Default)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.4691  -0.1418  -0.0557  -0.0203   3.7383  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.087e+01  4.923e-01 -22.080  &lt; 2e-16 ***
## balance      5.737e-03  2.319e-04  24.738  &lt; 2e-16 ***
## income       3.033e-06  8.203e-06   0.370  0.71152    
## studentYes  -6.468e-01  2.363e-01  -2.738  0.00619 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2920.6  on 9999  degrees of freedom
## Residual deviance: 1571.5  on 9996  degrees of freedom
## AIC: 1579.5
## 
## Number of Fisher Scoring iterations: 8</code></pre>
<p>Neither students nor non students have a dependence on income. Balance has nearly the same coefficient in all the models so with student in the model, so we may drop the income.<br></p>
<p><strong>Modeling without income</strong></p>
<div class="sourceCode" id="cb882"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Default.logit.out.noincome</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">default</span><span class="op">~</span><span class="va">balance</span><span class="op">+</span><span class="va">student</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link<span class="op">=</span><span class="va">logit</span><span class="op">)</span>,<span class="va">Default</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Default.logit.out.noincome</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = default ~ balance + student, family = binomial(link = logit), 
##     data = Default)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.4578  -0.1422  -0.0559  -0.0203   3.7435  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.075e+01  3.692e-01 -29.116  &lt; 2e-16 ***
## balance      5.738e-03  2.318e-04  24.750  &lt; 2e-16 ***
## studentYes  -7.149e-01  1.475e-01  -4.846 1.26e-06 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2920.6  on 9999  degrees of freedom
## Residual deviance: 1571.7  on 9997  degrees of freedom
## AIC: 1577.7
## 
## Number of Fisher Scoring iterations: 8</code></pre>
<p>Using the logit model the probability of default seems to be only a function of student status and balance, not income.<br></p>
<p><strong>Probit Model</strong></p>
<p>To use the probit model, we need to set family to binomial and link to probit.<br></p>
<div class="sourceCode" id="cb884"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Default.logit.out.allvar</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">default</span><span class="op">~</span><span class="va">balance</span><span class="op">+</span><span class="va">income</span><span class="op">+</span><span class="va">student</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link<span class="op">=</span><span class="va">probit</span><span class="op">)</span>,<span class="va">Default</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Default.logit.out.allvar</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = default ~ balance + income + student, family = binomial(link = probit), 
##     data = Default)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2226  -0.1354  -0.0321  -0.0044   4.1254  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -5.475e+00  2.385e-01 -22.960   &lt;2e-16 ***
## balance      2.821e-03  1.139e-04  24.774   &lt;2e-16 ***
## income       2.101e-06  4.121e-06   0.510   0.6101    
## studentYes  -2.960e-01  1.188e-01  -2.491   0.0127 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2920.6  on 9999  degrees of freedom
## Residual deviance: 1583.2  on 9996  degrees of freedom
## AIC: 1591.2
## 
## Number of Fisher Scoring iterations: 8</code></pre>
<p><strong>Probit no income</strong></p>
<div class="sourceCode" id="cb886"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Default.probit.out.noincome</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">default</span><span class="op">~</span><span class="va">balance</span><span class="op">+</span><span class="va">student</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link<span class="op">=</span><span class="va">probit</span><span class="op">)</span>,<span class="va">Default</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Default.probit.out.noincome</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = default ~ balance + student, family = binomial(link = probit), 
##     data = Default)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2056  -0.1353  -0.0322  -0.0044   4.1374  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -5.3918818  0.1728730 -31.190  &lt; 2e-16 ***
## balance      0.0028215  0.0001138  24.784  &lt; 2e-16 ***
## studentYes  -0.3429201  0.0743964  -4.609 4.04e-06 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2920.6  on 9999  degrees of freedom
## Residual deviance: 1583.5  on 9997  degrees of freedom
## AIC: 1589.5
## 
## Number of Fisher Scoring iterations: 8</code></pre>
<p>Logit has mildly sharper dependence on both balance and student status for fit than Probit.<br>
Income doesn’t matter, but student status does.<br>
What else matters is the balance owed.<br>
Increased balance: default more likely.<br>
Student status: default less likely.<br></p>
</div>
</div>
<div id="receiver-operating-characteristic" class="section level2">
<h2>
<span class="header-section-number">67.2</span> Receiver Operating Characteristic<a class="anchor" aria-label="anchor" href="#receiver-operating-characteristic"><i class="fas fa-link"></i></a>
</h2>
<p>Definitions:<br>
condition positive (P): the number of real positive cases in the data<br>
condition negative (N): the number of real negative cases in the data<br>
true positive (TP): eqv. with hit<br>
true negative (TN): eqv. with correct rejection<br>
false positive (FP): eqv. with false alarm, type I error or underestimation<br>
false negative (FN): eqv. with miss, type II error or overestimation<br></p>
<p>ROC plots true positive rate vs false positive rate as a function of threshold.<br></p>
<p>true positive rate TPR=TP/(TP+FN)<br>
false positive rate FPR=FP/(FP+TN)<br></p>
<div id="roc-in-r" class="section level3">
<h3>
<span class="header-section-number">67.2.1</span> ROC in R<a class="anchor" aria-label="anchor" href="#roc-in-r"><i class="fas fa-link"></i></a>
</h3>
<p>The function of ROC can build a ROC curve and return a “roc” object, a list of class “roc”, which can be printed and plotted. In the function of ROC, the first parameter is response, and the second parameter is predictor.</p>
<div class="sourceCode" id="cb888"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a test and train data set</span>
<span class="va">v1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">10000</span>,<span class="fl">6000</span><span class="op">)</span><span class="op">)</span>
<span class="va">Default.train</span><span class="op">&lt;-</span><span class="va">Default</span><span class="op">[</span><span class="va">v1</span>,<span class="op">]</span>
<span class="va">Default.test</span><span class="op">&lt;-</span><span class="va">Default</span><span class="op">[</span><span class="op">-</span><span class="va">v1</span>,<span class="op">]</span>
<span class="co">#Create a logit model using glm</span>
<span class="va">Default.train.out.noincome</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">default</span><span class="op">~</span><span class="va">balance</span><span class="op">+</span><span class="va">student</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link<span class="op">=</span><span class="va">logit</span><span class="op">)</span>,<span class="va">Default.train</span><span class="op">)</span>
<span class="co">#Predict the test data set</span>
<span class="va">Default.pred</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">Default.train.out.noincome</span>,<span class="va">Default.test</span>,type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="va">Default.test</span><span class="op">$</span><span class="va">default</span>,<span class="va">Default.pred</span>,plot<span class="op">=</span><span class="cn">T</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = Default.test$default, predictor = Default.pred,     plot = T)
## 
## Data: Default.pred in 3871 controls (Default.test$default No) &lt; 129 cases (Default.test$default Yes).
## Area under the curve: 0.9484</code></pre>
<div class="sourceCode" id="cb890"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Default.pred.self</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">Default.train.out.noincome</span>,type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span>
<span class="va">roc.train.str</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="va">Default.train</span><span class="op">$</span><span class="va">default</span>,<span class="va">Default.pred.self</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pROC/man/lines.roc.html">lines.roc</a></span><span class="op">(</span><span class="va">roc.train.str</span>,type<span class="op">=</span><span class="st">"lines"</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="models_and_prediction_evaluation_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"></div>
<p>In the plot, Sensitivity=True Positive Rate, Specificity=False Positive Rate.<br></p>
</div>
</div>
<div id="classification-and-regression-trees" class="section level2">
<h2>
<span class="header-section-number">67.3</span> Classification and Regression Trees<a class="anchor" aria-label="anchor" href="#classification-and-regression-trees"><i class="fas fa-link"></i></a>
</h2>
<div id="recursive-partitioning" class="section level3">
<h3>
<span class="header-section-number">67.3.1</span> Recursive Partitioning<a class="anchor" aria-label="anchor" href="#recursive-partitioning"><i class="fas fa-link"></i></a>
</h3>
<p>Recursive partitioning can be used either with regression or binary data.<br></p>
<p>We will introduce three of the choices.<br>
* tree - a few more options<br>
* rpart - nicer graphics<br>
* randomForest - different approach<br></p>
<p>Let’s see how these models work on the Auto data.<br></p>
</div>
<div id="basic-trees" class="section level3">
<h3>
<span class="header-section-number">67.3.2</span> Basic Trees<a class="anchor" aria-label="anchor" href="#basic-trees"><i class="fas fa-link"></i></a>
</h3>
<p>There are p dimensions, n data points.<br></p>
<p>Step 1: cycle through all p dimensions, all n-1 possible splits on those dimensions, Choose the 1 that now gives the most improvement in:<br>
* Sum of squares for regression<br>
* Likelihood for other models<br></p>
<p>Step 2: for each data set created, redo step 1 but select the 1 best division.<br></p>
<p>Go until some criteria is met.<br></p>
<p>Problems: Easy to overfit<br>
Step 1, prune back using cross validation to evaluate error. (chop off parts of tree somewhat automatic)<br></p>
<div class="sourceCode" id="cb891"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a training sample for Auto</span>
<span class="va">I1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">392</span>,<span class="fl">200</span><span class="op">)</span>
<span class="va">Auto1</span><span class="op">&lt;-</span><span class="va">Auto</span><span class="op">[</span><span class="va">I1</span>,<span class="op">]</span>
<span class="va">Auto2</span><span class="op">&lt;-</span><span class="va">Auto</span><span class="op">[</span><span class="op">-</span><span class="va">I1</span>,<span class="op">]</span>
<span class="va">dum0tree</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/tree/man/tree.html">tree</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">~</span><span class="va">cylinders</span><span class="op">+</span><span class="va">displacement</span><span class="op">+</span><span class="va">horsepower</span><span class="op">+</span><span class="va">weight</span><span class="op">+</span><span class="va">year</span><span class="op">+</span><span class="va">acceleration</span>,data<span class="op">=</span><span class="va">Auto1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pROC/man/plot.roc.html">plot</a></span><span class="op">(</span><span class="va">dum0tree</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">dum0tree</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="models_and_prediction_evaluation_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb892"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mpg2tree</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">dum0tree</span>,newdata<span class="op">=</span><span class="va">Auto2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pROC/man/plot.roc.html">plot</a></span><span class="op">(</span><span class="va">mpg2tree</span>,<span class="va">Auto2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="models_and_prediction_evaluation_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="rpart-recursive-partitioning-and-regression-trees" class="section level3">
<h3>
<span class="header-section-number">67.3.3</span> Rpart: Recursive Partitioning and Regression Trees<a class="anchor" aria-label="anchor" href="#rpart-recursive-partitioning-and-regression-trees"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb893"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dum0rpart</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">~</span><span class="va">cylinders</span><span class="op">+</span><span class="va">displacement</span><span class="op">+</span><span class="va">horsepower</span><span class="op">+</span><span class="va">weight</span><span class="op">+</span><span class="va">year</span><span class="op">+</span><span class="va">acceleration</span>,data<span class="op">=</span><span class="va">Auto1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pROC/man/plot.roc.html">plot</a></span><span class="op">(</span><span class="va">dum0rpart</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">dum0rpart</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="models_and_prediction_evaluation_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb894"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mpg2rpart</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">dum0rpart</span>,newdata<span class="op">=</span><span class="va">Auto2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pROC/man/plot.roc.html">plot</a></span><span class="op">(</span><span class="va">mpg2rpart</span>,<span class="va">Auto2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="models_and_prediction_evaluation_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Here we can see that tree and rpart are doing the same thing in regression.<br></p>
</div>
<div id="random-forests" class="section level3">
<h3>
<span class="header-section-number">67.3.4</span> Random Forests<a class="anchor" aria-label="anchor" href="#random-forests"><i class="fas fa-link"></i></a>
</h3>
<p>There are p dimensions, n data points.<br></p>
<p>Step 1: cycle through all a random selection of the dimensions, and a random selection of n-1 possible splits on those dimensions, Choose the 1 that now gives the most improvement in :<br>
* Sum of squares for regression<br>
* Likelihood for other models<br></p>
<p>Step 2: for each data set created, redo step 1 but with new randomly selected dimensions and divisions.<br></p>
<p>Step 3: repeat 1 and 2 on original data until a number of random trees are made.<br></p>
<p>For classification, each tree gets 1 vote (or is averaged) for the prediction of the new data.<br></p>
<p>NICE result, large n big forest, does not over fit.<br></p>
<div class="sourceCode" id="cb895"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dum0forest</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">~</span><span class="va">cylinders</span><span class="op">+</span><span class="va">displacement</span><span class="op">+</span><span class="va">horsepower</span><span class="op">+</span><span class="va">weight</span><span class="op">+</span><span class="va">year</span><span class="op">+</span><span class="va">acceleration</span>,data<span class="op">=</span><span class="va">Auto1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pROC/man/plot.roc.html">plot</a></span><span class="op">(</span><span class="va">dum0forest</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="models_and_prediction_evaluation_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Plot here tells us if forest is large enough for the error to converge.<br></p>
<div class="sourceCode" id="cb896"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mpg2forest</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">dum0forest</span>,newdata<span class="op">=</span><span class="va">Auto2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pROC/man/plot.roc.html">plot</a></span><span class="op">(</span><span class="va">mpg2forest</span>,<span class="va">Auto2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="models_and_prediction_evaluation_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="we-can-use-tree-rpart-and-random-forest-on-binary-data-too" class="section level3">
<h3>
<span class="header-section-number">67.3.5</span> We can use tree, rpart, and random forest on binary data too<a class="anchor" aria-label="anchor" href="#we-can-use-tree-rpart-and-random-forest-on-binary-data-too"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s go back to the Default data and create the model of train data set using different methods.</p>
<p><strong>Basic Trees</strong></p>
<div class="sourceCode" id="cb897"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Default.tree.train.out.noincome</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/tree/man/tree.html">tree</a></span><span class="op">(</span><span class="va">default</span><span class="op">~</span><span class="va">balance</span><span class="op">+</span><span class="va">student</span>,<span class="va">Default.train</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pROC/man/plot.roc.html">plot</a></span><span class="op">(</span><span class="va">Default.tree.train.out.noincome</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">Default.tree.train.out.noincome</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="models_and_prediction_evaluation_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;"></div>
<p><strong>Rpart</strong></p>
<div class="sourceCode" id="cb898"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Default.rpart.train.out.noincome</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart</a></span><span class="op">(</span><span class="va">default</span><span class="op">~</span><span class="va">balance</span><span class="op">+</span><span class="va">student</span>,<span class="va">Default.train</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pROC/man/plot.roc.html">plot</a></span><span class="op">(</span><span class="va">Default.rpart.train.out.noincome</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">Default.rpart.train.out.noincome</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="models_and_prediction_evaluation_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;"></div>
<p><strong>Random Forests</strong></p>
<div class="sourceCode" id="cb899"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Default.rf.train.out.noincome</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span><span class="va">default</span><span class="op">~</span><span class="va">balance</span><span class="op">+</span><span class="va">student</span>,<span class="va">Default.train</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pROC/man/plot.roc.html">plot</a></span><span class="op">(</span><span class="va">Default.rf.train.out.noincome</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="models_and_prediction_evaluation_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="roc-on-tree-rpart-and-random-forest" class="section level3">
<h3>
<span class="header-section-number">67.3.6</span> ROC on tree, rpart, and random forest<a class="anchor" aria-label="anchor" href="#roc-on-tree-rpart-and-random-forest"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb900"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Predict the test data set</span>
<span class="va">tree.test.pred</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">Default.tree.train.out.noincome</span>,<span class="va">Default.test</span><span class="op">)</span>
<span class="va">rpart.test.pred</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">Default.rpart.train.out.noincome</span>,<span class="va">Default.test</span><span class="op">)</span>
<span class="va">Default.rf.test.pred</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">Default.rf.train.out.noincome</span>,<span class="va">Default.test</span>,type<span class="op">=</span><span class="st">"prob"</span><span class="op">)</span>
<span class="co">#roc for tree</span>
<span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="va">Default.test</span><span class="op">$</span><span class="va">default</span>,<span class="va">tree.test.pred</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,plot<span class="op">=</span><span class="cn">T</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = Default.test$default, predictor = tree.test.pred[,     2], plot = T)
## 
## Data: tree.test.pred[, 2] in 3871 controls (Default.test$default No) &lt; 129 cases (Default.test$default Yes).
## Area under the curve: 0.9149</code></pre>
<div class="sourceCode" id="cb902"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#roc for rpart</span>
<span class="va">roc.rpart.default.pred</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="va">Default.test</span><span class="op">$</span><span class="va">default</span>,<span class="va">rpart.test.pred</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pROC/man/lines.roc.html">lines.roc</a></span><span class="op">(</span><span class="va">roc.rpart.default.pred</span>,type<span class="op">=</span><span class="st">"lines"</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">roc.rpart.default.pred</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = Default.test$default, predictor = rpart.test.pred[,     2])
## 
## Data: rpart.test.pred[, 2] in 3871 controls (Default.test$default No) &lt; 129 cases (Default.test$default Yes).
## Area under the curve: 0.704</code></pre>
<div class="sourceCode" id="cb904"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#roc for random forest</span>
<span class="va">rf.roc.pred</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="va">Default.test</span><span class="op">$</span><span class="va">default</span>,<span class="va">Default.rf.test.pred</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pROC/man/lines.roc.html">lines.roc</a></span><span class="op">(</span><span class="va">rf.roc.pred</span>,type<span class="op">=</span><span class="st">"lines"</span>,col<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="models_and_prediction_evaluation_files/figure-html/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb905"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">rf.roc.pred</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = Default.test$default, predictor = Default.rf.test.pred[,     2])
## 
## Data: Default.rf.test.pred[, 2] in 3871 controls (Default.test$default No) &lt; 129 cases (Default.test$default Yes).
## Area under the curve: 0.8097</code></pre>
<p>We can compare the models and evaluate the predictions both from the ROC Area Under the Curve and the plot.<br>
ROC AUC for the tree model is 0.9297, ROC AUC for the rpart model is 0.7479, and ROC AUC for the random forest model is 0.8172. 0.9297 &gt; 0.8172 &gt; 0.7479, so the tree model performs the best, while the rpart model performs the worst.<br>
In this plot, the black line represents the tree model, the red line represents the rpart model, and the green line represents the random forest model. We can observe that the tree model has the best performance, while the rpart model has the worst performance.<br>
These two results are consistent.<br></p>
</div>
</div>
<div id="reference-5" class="section level2">
<h2>
<span class="header-section-number">67.4</span> Reference<a class="anchor" aria-label="anchor" href="#reference-5"><i class="fas fa-link"></i></a>
</h2>
<p><a href="https://en.wikipedia.org/wiki/Probit_model" class="uri">https://en.wikipedia.org/wiki/Probit_model</a><br><a href="https://en.wikipedia.org/wiki/Logistic_regression#Definition_of_the_logistic_function" class="uri">https://en.wikipedia.org/wiki/Logistic_regression#Definition_of_the_logistic_function</a><br><a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/glm" class="uri">https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/glm</a><br><a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/family" class="uri">https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/family</a><br><a href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic" class="uri">https://en.wikipedia.org/wiki/Receiver_operating_characteristic</a><br><a href="https://www.rdocumentation.org/packages/pROC/versions/1.16.2/topics/roc" class="uri">https://www.rdocumentation.org/packages/pROC/versions/1.16.2/topics/roc</a><br></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="r-to-python-easy-plot.html"><span class="header-section-number">66</span> R to python easy plot</a></div>
<div class="next"><a href="introduction-to-interactive-time-series-visualizations-with-dygraphs-in-r.html"><span class="header-section-number">68</span> Introduction to Interactive Time Series Visualizations with dygraphs in R</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#introduction-to-models-and-prediction-evaluation"><span class="header-section-number">67</span> Introduction to models and prediction evaluation</a></li>
<li>
<a class="nav-link" href="#models-for-binomial-data"><span class="header-section-number">67.1</span> Models for binomial data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#profit-model"><span class="header-section-number">67.1.1</span> Profit model</a></li>
<li><a class="nav-link" href="#logit-model"><span class="header-section-number">67.1.2</span> Logit model</a></li>
<li><a class="nav-link" href="#how-to-fit-these-and-choose-models"><span class="header-section-number">67.1.3</span> How to fit these and choose models</a></li>
<li><a class="nav-link" href="#we-will-use-glm-to-fit-and-analyze-models"><span class="header-section-number">67.1.4</span> We will use GLM to fit and analyze models</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#receiver-operating-characteristic"><span class="header-section-number">67.2</span> Receiver Operating Characteristic</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#roc-in-r"><span class="header-section-number">67.2.1</span> ROC in R</a></li></ul>
</li>
<li>
<a class="nav-link" href="#classification-and-regression-trees"><span class="header-section-number">67.3</span> Classification and Regression Trees</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#recursive-partitioning"><span class="header-section-number">67.3.1</span> Recursive Partitioning</a></li>
<li><a class="nav-link" href="#basic-trees"><span class="header-section-number">67.3.2</span> Basic Trees</a></li>
<li><a class="nav-link" href="#rpart-recursive-partitioning-and-regression-trees"><span class="header-section-number">67.3.3</span> Rpart: Recursive Partitioning and Regression Trees</a></li>
<li><a class="nav-link" href="#random-forests"><span class="header-section-number">67.3.4</span> Random Forests</a></li>
<li><a class="nav-link" href="#we-can-use-tree-rpart-and-random-forest-on-binary-data-too"><span class="header-section-number">67.3.5</span> We can use tree, rpart, and random forest on binary data too</a></li>
<li><a class="nav-link" href="#roc-on-tree-rpart-and-random-forest"><span class="header-section-number">67.3.6</span> ROC on tree, rpart, and random forest</a></li>
</ul>
</li>
<li><a class="nav-link" href="#reference-5"><span class="header-section-number">67.4</span> Reference</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/jtr13/cc21fall2/blob/main/models_and_prediction_evaluation.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/jtr13/cc21fall2/edit/main/models_and_prediction_evaluation.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>EDAV Fall 2021 Tues/Thurs Community Contributions</strong>" was written by . It was last built on 2021-11-24.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
