<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 75 A Step by Step Tutorial for Natural Language Processing in R | EDAV Fall 2021 Tues/Thurs Community Contributions</title>
<meta name="description" content="Yuwen Zhang Natural language processing (NLP) is an intersection of linguistics, computer science, and artificial intelligence aiming to tackle the interactions between computers and human...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 75 A Step by Step Tutorial for Natural Language Processing in R | EDAV Fall 2021 Tues/Thurs Community Contributions">
<meta property="og:type" content="book">
<meta property="og:description" content="Yuwen Zhang Natural language processing (NLP) is an intersection of linguistics, computer science, and artificial intelligence aiming to tackle the interactions between computers and human...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 75 A Step by Step Tutorial for Natural Language Processing in R | EDAV Fall 2021 Tues/Thurs Community Contributions">
<meta name="twitter:description" content="Yuwen Zhang Natural language processing (NLP) is an intersection of linguistics, computer science, and artificial intelligence aiming to tackle the interactions between computers and human...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/forceNetwork-binding-0.4/forceNetwork.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="libs/vis-9.1.0/vis-network.min.js"></script><script src="libs/visNetwork-binding-2.1.0/visNetwork.js"></script><link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet">
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script><script src="libs/dygraphs-1.1.1/shapes.js"></script><script src="libs/moment-2.8.4/moment.js"></script><script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script><script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script><script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script><script src="libs/proj4js-2.3.15/proj4.js"></script><link href="libs/highcharts-8.1.2/css/motion.css" rel="stylesheet">
<script src="libs/highcharts-8.1.2/highcharts.js"></script><script src="libs/highcharts-8.1.2/highcharts-3d.js"></script><script src="libs/highcharts-8.1.2/highcharts-more.js"></script><script src="libs/highcharts-8.1.2/modules/stock.js"></script><script src="libs/highcharts-8.1.2/modules/map.js"></script><script src="libs/highcharts-8.1.2/modules/annotations.js"></script><script src="libs/highcharts-8.1.2/modules/data.js"></script><script src="libs/highcharts-8.1.2/modules/drilldown.js"></script><script src="libs/highcharts-8.1.2/modules/item-series.js"></script><script src="libs/highcharts-8.1.2/modules/offline-exporting.js"></script><script src="libs/highcharts-8.1.2/modules/overlapping-datalabels.js"></script><script src="libs/highcharts-8.1.2/modules/exporting.js"></script><script src="libs/highcharts-8.1.2/modules/export-data.js"></script><script src="libs/highcharts-8.1.2/modules/funnel.js"></script><script src="libs/highcharts-8.1.2/modules/heatmap.js"></script><script src="libs/highcharts-8.1.2/modules/treemap.js"></script><script src="libs/highcharts-8.1.2/modules/sankey.js"></script><script src="libs/highcharts-8.1.2/modules/dependency-wheel.js"></script><script src="libs/highcharts-8.1.2/modules/organization.js"></script><script src="libs/highcharts-8.1.2/modules/solid-gauge.js"></script><script src="libs/highcharts-8.1.2/modules/streamgraph.js"></script><script src="libs/highcharts-8.1.2/modules/sunburst.js"></script><script src="libs/highcharts-8.1.2/modules/vector.js"></script><script src="libs/highcharts-8.1.2/modules/wordcloud.js"></script><script src="libs/highcharts-8.1.2/modules/xrange.js"></script><script src="libs/highcharts-8.1.2/modules/tilemap.js"></script><script src="libs/highcharts-8.1.2/modules/venn.js"></script><script src="libs/highcharts-8.1.2/modules/gantt.js"></script><script src="libs/highcharts-8.1.2/modules/timeline.js"></script><script src="libs/highcharts-8.1.2/modules/parallel-coordinates.js"></script><script src="libs/highcharts-8.1.2/modules/bullet.js"></script><script src="libs/highcharts-8.1.2/modules/coloraxis.js"></script><script src="libs/highcharts-8.1.2/modules/dumbbell.js"></script><script src="libs/highcharts-8.1.2/modules/lollipop.js"></script><script src="libs/highcharts-8.1.2/modules/series-label.js"></script><script src="libs/highcharts-8.1.2/plugins/motion.js"></script><script src="libs/highcharts-8.1.2/custom/reset.js"></script><script src="libs/highcharts-8.1.2/modules/boost.js"></script><script src="libs/highchart-binding-0.8.2/highchart.js"></script><script src="libs/detect-resize-0.5.3/jquery.resize.js"></script><link href="libs/jquery-ui-1.11.4/jquery-ui.min.css" rel="stylesheet">
<script src="libs/jquery-ui-1.11.4/jquery-ui.min.js"></script><script src="libs/vega-1.4.3/vega.min.js"></script><script src="libs/lodash-2.2.1/lodash.min.js"></script><script>var lodash = _.noConflict();</script><link href="libs/ggvis-0.4.7/css/ggvis.css" rel="stylesheet">
<script src="libs/ggvis-0.4.7/js/ggvis.js"></script><link href="libs/wordcloud2-0.0.1/wordcloud.css" rel="stylesheet">
<script src="libs/wordcloud2-0.0.1/wordcloud2-all.js"></script><script src="libs/wordcloud2-0.0.1/hover.js"></script><script src="libs/wordcloud2-binding-0.2.1/wordcloud2.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">EDAV Fall 2021 Tues/Thurs Community Contributions</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome!</a></li>
<li><a class="" href="community-contribution.html"><span class="header-section-number">2</span> Community Contribution</a></li>
<li><a class="" href="github-submission-instructions.html"><span class="header-section-number">3</span> GitHub submission instructions</a></li>
<li><a class="" href="sample-project.html"><span class="header-section-number">4</span> Sample project</a></li>
<li class="book-part">Cheatsheets</li>
<li><a class="" href="statistics-in-r-vs-python.html"><span class="header-section-number">5</span> Statistics in R vs Python</a></li>
<li><a class="" href="data-visualization-with-seaborn.html"><span class="header-section-number">6</span> Data Visualization with Seaborn</a></li>
<li><a class="" href="how-to-make-your-own-r-package.html"><span class="header-section-number">7</span> How to Make Your Own R package</a></li>
<li><a class="" href="rchess-package-cheatsheet.html"><span class="header-section-number">8</span> RChess package cheatsheet</a></li>
<li><a class="" href="hypothesis-testing-cheatsheet.html"><span class="header-section-number">9</span> Hypothesis testing cheatsheet</a></li>
<li><a class="" href="interactive-web-visualizations-for-r-cheatsheet.html"><span class="header-section-number">10</span> Interactive web visualizations for R cheatsheet"</a></li>
<li><a class="" href="ggforce.html"><span class="header-section-number">11</span> ggforce</a></li>
<li><a class="" href="gganimate-cheatsheet.html"><span class="header-section-number">12</span> GGanimate cheatsheet</a></li>
<li><a class="" href="statistical-tests-and-parameter-estimations-in-r-cheatsheet.html"><span class="header-section-number">13</span> Statistical Tests and Parameter Estimations in R Cheatsheet</a></li>
<li><a class="" href="ggalluvial-cheat-sheet.html"><span class="header-section-number">14</span> ggalluvial-cheat-sheet</a></li>
<li><a class="" href="introduction-to-plotly.html"><span class="header-section-number">15</span> Introduction to plotly</a></li>
<li><a class="" href="draw-graphs-using-python-and-r.html"><span class="header-section-number">16</span> draw graphs using python and R</a></li>
<li><a class="" href="data-visualization-packages-in-r.html"><span class="header-section-number">17</span> Data Visualization Packages in R</a></li>
<li><a class="" href="esquisse-cheat-sheet.html"><span class="header-section-number">18</span> Esquisse Cheat sheet</a></li>
<li><a class="" href="review-sheet-for-r-code-and-data-transformation.html"><span class="header-section-number">19</span> review sheet for r code and data transformation</a></li>
<li><a class="" href="scrape-twitter-data-using-r.html"><span class="header-section-number">20</span> Scrape Twitter data using R</a></li>
<li><a class="" href="r-note-and-mathematics-in-rmd-cheatsheet.html"><span class="header-section-number">21</span> R note and Mathematics in Rmd cheatsheet</a></li>
<li><a class="" href="textbook-notes.html"><span class="header-section-number">22</span> Textbook Notes</a></li>
<li><a class="" href="ggplot2-cheatsheet.html"><span class="header-section-number">23</span> ggplot2 cheatsheet</a></li>
<li><a class="" href="rstudio-cheatsheet.html"><span class="header-section-number">24</span> RStudio Cheatsheet</a></li>
<li><a class="" href="d3-visualization-in-r-cheatsheet.html"><span class="header-section-number">25</span> D3 Visualization in R Cheatsheet</a></li>
<li><a class="" href="colors.html"><span class="header-section-number">26</span> Colors</a></li>
<li><a class="" href="r-data-sets.html"><span class="header-section-number">27</span> R data sets</a></li>
<li><a class="" href="introduction-to-plotly-1.html"><span class="header-section-number">28</span> “Introduction to Plotly”</a></li>
<li><a class="" href="tidyverse-cheatsheet.html"><span class="header-section-number">29</span> Tidyverse Cheatsheet</a></li>
<li><a class="" href="learning-sql-with-its-r-dplyr-translation.html"><span class="header-section-number">30</span> Learning SQL with Its R dplyr Translation</a></li>
<li><a class="" href="animate-time-series-the-goyav-package.html"><span class="header-section-number">31</span> Animate Time Series : the goyav package</a></li>
<li><a class="" href="string-manipulation-in-r.html"><span class="header-section-number">32</span> String Manipulation in R</a></li>
<li><a class="" href="ggalluvial-cheatsheet.html"><span class="header-section-number">33</span> ggalluvial Cheatsheet</a></li>
<li><a class="" href="a-cheatsheet-from-pandas-to-base-r-and-tidyverse.html"><span class="header-section-number">34</span> A cheatsheet from pandas to base r and tidyverse</a></li>
<li><a class="" href="base-r-ggplot2-python-graphing-performances.html"><span class="header-section-number">35</span> Base R, ggplot2, &amp; Python Graphing Performances</a></li>
<li><a class="" href="cheat-sheet-to-score-100-points.html"><span class="header-section-number">36</span> Cheat Sheet to Score 100 Points</a></li>
<li><a class="" href="base-r-string-operations-cheatsheet.html"><span class="header-section-number">37</span> Base R String Operations Cheatsheet</a></li>
<li><a class="" href="data-manipulation-in-r.html"><span class="header-section-number">38</span> Data manipulation in R</a></li>
<li><a class="" href="ggplot_matplotlib_cheatsheet.html"><span class="header-section-number">39</span> ggplot_matplotlib_cheatsheet</a></li>
<li><a class="" href="introduction-to-log-transformation.html"><span class="header-section-number">40</span> Introduction to Log-transformation</a></li>
<li class="book-part">R Tutorials</li>
<li><a class="" href="how-to-integrate-r-with-postgresql.html"><span class="header-section-number">41</span> How to Integrate R with PostgreSQL</a></li>
<li><a class="" href="tutorial-on-cluster-analysis.html"><span class="header-section-number">42</span> Tutorial on Cluster Analysis</a></li>
<li><a class="" href="tutorial-on-cluster-analysis-1.html"><span class="header-section-number">43</span> Tutorial on Cluster Analysis</a></li>
<li><a class="" href="apply-function-in-r.html"><span class="header-section-number">44</span> Apply function in r</a></li>
<li><a class="" href="introduction-to-interactive-graphs-in-r.html"><span class="header-section-number">45</span> Introduction to interactive graphs in R</a></li>
<li><a class="" href="plot-and-analyze-stock-data-with-r.html"><span class="header-section-number">46</span> Plot and Analyze Stock Data with R</a></li>
<li><a class="" href="data-visulization-ordering.html"><span class="header-section-number">47</span> Data Visulization Ordering</a></li>
<li><a class="" href="tutorial-on-lattice-package-in-r.html"><span class="header-section-number">48</span> Tutorial on lattice package in R</a></li>
<li><a class="" href="network-visualization-in-r.html"><span class="header-section-number">49</span> Network Visualization in R</a></li>
<li><a class="" href="dplyr-tutorial-in-r.html"><span class="header-section-number">50</span> Dplyr tutorial in R</a></li>
<li><a class="" href="downloading-files.html"><span class="header-section-number">51</span> Downloading files</a></li>
<li><a class="" href="video-introduction-to-maps-with-ggmap.html"><span class="header-section-number">52</span> Video introduction to maps with ggmap</a></li>
<li><a class="" href="comparison-among-base-r-tidyverse-and-datatable.html"><span class="header-section-number">53</span> Comparison among base R, tidyverse, and datatable</a></li>
<li><a class="" href="raincloud-plot-101-density-plot-or-boxplotwhy-not-do-both.html"><span class="header-section-number">54</span> Raincloud plot 101: density plot or boxplot？Why not do both!</a></li>
<li><a class="" href="an-introduction-to-dygraph-in-r.html"><span class="header-section-number">55</span> An Introduction to Dygraph in R</a></li>
<li><a class="" href="streamlit-tutorial.html"><span class="header-section-number">56</span> Streamlit Tutorial</a></li>
<li><a class="" href="hive-plots-with-the-ggraph-and-hiver-packages.html"><span class="header-section-number">57</span> Hive plots with the ggraph and hiver packages</a></li>
<li><a class="" href="introduction-to-xai-explainable-ai-in-r.html"><span class="header-section-number">58</span> Introduction to XAI (Explainable AI) in R</a></li>
<li><a class="" href="tutorial-for-gg_cleveland.html"><span class="header-section-number">59</span> Tutorial for gg_cleveland</a></li>
<li><a class="" href="neural-network-tools-in-r.html"><span class="header-section-number">60</span> Neural network tools in R</a></li>
<li><a class="" href="readable-plots.html"><span class="header-section-number">61</span> Readable Plots</a></li>
<li><a class="" href="introduction-to-exploratory-spatial-data-analysis-and-visualization-using-qgis.html"><span class="header-section-number">62</span> Introduction to exploratory spatial data analysis and visualization using QGIS</a></li>
<li><a class="" href="base-r-tutorial.html"><span class="header-section-number">63</span> Base R Tutorial</a></li>
<li><a class="" href="introduction-to-models-and-prediction-evaluation.html"><span class="header-section-number">64</span> Introduction to models and prediction evaluation</a></li>
<li><a class="" href="introduction-to-interactive-time-series-visualizations-with-dygraphs-in-r.html"><span class="header-section-number">65</span> Introduction to Interactive Time Series Visualizations with dygraphs in R</a></li>
<li><a class="" href="gganimate-tutorial.html"><span class="header-section-number">66</span> Gganimate Tutorial</a></li>
<li><a class="" href="get-nba-dataset-in-r.html"><span class="header-section-number">67</span> Get NBA dataset in R</a></li>
<li><a class="" href="mtemplates.html"><span class="header-section-number">68</span> Mtemplates</a></li>
<li><a class="" href="introduction-to-time-series-analysis-in-r.html"><span class="header-section-number">69</span> Introduction to Time Series Analysis in R</a></li>
<li><a class="" href="storytelling-with-data.html"><span class="header-section-number">70</span> Storytelling with Data</a></li>
<li><a class="" href="tutorial-on-r-torch-package.html"><span class="header-section-number">71</span> Tutorial on R torch package</a></li>
<li><a class="" href="edav-tutorials-correlogram-calendar-heatmap-and-slopegram.html"><span class="header-section-number">72</span> EDAV Tutorials: Correlogram, Calendar Heatmap and Slopegram</a></li>
<li><a class="" href="recursive-codes-and-self-organized-map-with-r.html"><span class="header-section-number">73</span> Recursive codes and self-organized map with R</a></li>
<li><a class="" href="tutorial-of-three-ggplot2-based-packages.html"><span class="header-section-number">74</span> Tutorial of three ggplot2 based packages</a></li>
<li><a class="active" href="a-step-by-step-tutorial-for-natural-language-processing-in-r.html"><span class="header-section-number">75</span> A Step by Step Tutorial for Natural Language Processing in R</a></li>
<li><a class="" href="tutorial-for-ggvis-and-its-comparison-with-ggplot2.html"><span class="header-section-number">76</span> Tutorial for ggvis and its Comparison with ggplot2</a></li>
<li><a class="" href="feature-selection-in-r.html"><span class="header-section-number">77</span> Feature selection in r</a></li>
<li><a class="" href="debugging-in-rstudio.html"><span class="header-section-number">78</span> Debugging in Rstudio</a></li>
<li><a class="" href="r-tutorial-cheatsheet.html"><span class="header-section-number">79</span> R tutorial cheatsheet</a></li>
<li><a class="" href="brief-introduction-of-ggpubr.html"><span class="header-section-number">80</span> Brief Introduction of ggpubr</a></li>
<li><a class="" href="r-based-data-organization-and-visualization.html"><span class="header-section-number">81</span> R based data organization and visualization</a></li>
<li><a class="" href="r-packages-for-map-visualization.html"><span class="header-section-number">82</span> R packages for map Visualization</a></li>
<li><a class="" href="common-git-command-lines-tutorial-when-working-on-studio.html"><span class="header-section-number">83</span> Common git command lines tutorial when working on studio</a></li>
<li><a class="" href="tutorial-of-radar-chart.html"><span class="header-section-number">84</span> Tutorial of radar chart</a></li>
<li><a class="" href="interactive-radar.html"><span class="header-section-number">85</span> Interactive Radar</a></li>
<li><a class="" href="r-shiny-tutorial.html"><span class="header-section-number">86</span> R shiny tutorial</a></li>
<li><a class="" href="tutorial-on-r-markdown.html"><span class="header-section-number">87</span> Tutorial on R Markdown</a></li>
<li><a class="" href="dlookr-package.html"><span class="header-section-number">88</span> Dlookr package</a></li>
<li><a class="" href="urca-unit-root-test-and-cointegration-test.html"><span class="header-section-number">89</span> Urca: Unit Root Test and Cointegration Test</a></li>
<li><a class="" href="comparing-excel-chart-making-with-rs.html"><span class="header-section-number">90</span> Comparing Excel Chart Making with R’s</a></li>
<li><a class="" href="joining-and-reshaping-in-r.html"><span class="header-section-number">91</span> Joining and reshaping in R</a></li>
<li><a class="" href="running-sql-queries-on-dataframes.html"><span class="header-section-number">92</span> Running Sql Queries on Dataframes</a></li>
<li><a class="" href="tidyverse.html"><span class="header-section-number">93</span> TidyVerse</a></li>
<li><a class="" href="how-to-animate-your-plots.html"><span class="header-section-number">94</span> How to animate your plots</a></li>
<li><a class="" href="dataframe-operations-tutorial.html"><span class="header-section-number">95</span> Dataframe operations tutorial</a></li>
<li><a class="" href="a-brief-instruction-for-the-half-semester-of-edav5702.html"><span class="header-section-number">96</span> A brief instruction for the half semester of EDAV5702</a></li>
<li><a class="" href="anova-tutorial.html"><span class="header-section-number">97</span> ANOVA tutorial</a></li>
<li><a class="" href="predictive-analytics-using-data-visualization-in-r.html"><span class="header-section-number">98</span> Predictive Analytics using Data Visualization in R</a></li>
<li><a class="" href="color-selection-for-ggplot-graphs.html"><span class="header-section-number">99</span> Color selection for ggplot graphs</a></li>
<li><a class="" href="useful-resources-for-r-beginners.html"><span class="header-section-number">100</span> Useful resources for R beginners</a></li>
<li><a class="" href="tutorial-on-using-mongodb-with-r.html"><span class="header-section-number">101</span> Tutorial on Using MongoDB with R</a></li>
<li><a class="" href="rdoc---an-alfred-worflow-to-search-r-documentation.html"><span class="header-section-number">102</span> rdoc - An Alfred Worflow to Search R Documentation</a></li>
<li><a class="" href="data-frame-reshape.html"><span class="header-section-number">103</span> Data Frame Reshape</a></li>
<li><a class="" href="using-postgresql-databse-in-r-with-macos-environment.html"><span class="header-section-number">104</span> Using PostgreSQL Databse in R with MacOS Environment</a></li>
<li><a class="" href="spark-tutorial-in-r.html"><span class="header-section-number">105</span> Spark Tutorial In R</a></li>
<li><a class="" href="d-visualization-with-rgl-and-scatterplot3d.html"><span class="header-section-number">106</span> 3D Visualization with rgl and scatterplot3d</a></li>
<li><a class="" href="base-r-vs.-ggplot2-visualization.html"><span class="header-section-number">107</span> Base r vs. ggplot2 visualization</a></li>
<li><a class="" href="improved-density-estimation.html"><span class="header-section-number">108</span> Improved density estimation</a></li>
<li><a class="" href="plotting-theme-for-columbia.html"><span class="header-section-number">109</span> Plotting theme for Columbia</a></li>
<li><a class="" href="geospatial-data-visualization.html"><span class="header-section-number">110</span> Geospatial Data Visualization</a></li>
<li><a class="" href="neo4j-python-implementation.html"><span class="header-section-number">111</span> Neo4j python implementation</a></li>
<li><a class="" href="super-ggformat.html"><span class="header-section-number">112</span> Super ggformat</a></li>
<li><a class="" href="data_composition_plot.html"><span class="header-section-number">113</span> Data_Composition_Plot</a></li>
<li><a class="" href="ggplot2_treemapify.html"><span class="header-section-number">114</span> ggplot2_treemapify</a></li>
<li><a class="" href="tutorial-for-scatter-plot-with-marginal-distribution.html"><span class="header-section-number">115</span> Tutorial for scatter plot with marginal distribution</a></li>
<li class="book-part">R Tutorials</li>
<li><a class="" href="d-data-and-potential-relationship-visualization.html"><span class="header-section-number">116</span> 3D data and potential relationship visualization</a></li>
<li><a class="" href="using-python-in-r.html"><span class="header-section-number">117</span> Using python in r</a></li>
<li><a class="" href="plotting-graph-with-r-v.s.-python.html"><span class="header-section-number">118</span> Plotting graph with R v.s. Python</a></li>
<li><a class="" href="ggplot2-in-python.html"><span class="header-section-number">119</span> ggplot2 in python</a></li>
<li><a class="" href="pygal-tutorial.html"><span class="header-section-number">120</span> pygal tutorial</a></li>
<li><a class="" href="integrate-r-with-python.html"><span class="header-section-number">121</span> Integrate R with Python</a></li>
<li><a class="" href="python-visualization-tutorial.html"><span class="header-section-number">122</span> Python Visualization Tutorial</a></li>
<li><a class="" href="python-altair-visualization-method-tutorial.html"><span class="header-section-number">123</span> Python Altair Visualization Method Tutorial</a></li>
<li><a class="" href="r-to-python-easy-plot.html"><span class="header-section-number">124</span> R to python easy plot</a></li>
<li><a class="" href="r-dplyr-vs-python-pandas.html"><span class="header-section-number">125</span> R Dplyr vs Python Pandas</a></li>
<li><a class="" href="an-introduction-to-pyecharts-package-in-python.html"><span class="header-section-number">126</span> An introduction to pyecharts package in Python</a></li>
<li><a class="" href="visualization-in-r-v.s.-python.html"><span class="header-section-number">127</span> Visualization in R v.s. Python</a></li>
<li><a class="" href="understand-data-with-plots.html"><span class="header-section-number">128</span> Understand data with plots</a></li>
<li><a class="" href="r-and-python-visualization.html"><span class="header-section-number">129</span> R and Python visualization</a></li>
<li><a class="" href="data-visualization-in-python-vs-r.html"><span class="header-section-number">130</span> Data Visualization in Python vs R</a></li>
<li><a class="" href="python-visualization-tutorial-1.html"><span class="header-section-number">131</span> Python Visualization Tutorial</a></li>
<li class="book-part">Project &amp; Workshops</li>
<li><a class="" href="introduction-to-analytics-consulting-at-accenture.html"><span class="header-section-number">132</span> Introduction to analytics consulting at Accenture</a></li>
<li><a class="" href="map-of-the-r-world.html"><span class="header-section-number">133</span> Map of the R world</a></li>
<li><a class="" href="alluvial-diagrams-and-their-implementation-using-ggalluvial-in-r.html"><span class="header-section-number">134</span> Alluvial diagrams and their implementation using GGalluvial in R</a></li>
<li><a class="" href="building-a-dashboard-in-r-for-data-analysis-and-visualization-using-shiny-package.html"><span class="header-section-number">135</span> Building a Dashboard in R for Data Analysis and Visualization using shiny package</a></li>
<li><a class="" href="rgl-package.html"><span class="header-section-number">136</span> RGL Package</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="github-initial-setup.html"><span class="header-section-number">137</span> Github initial setup</a></li>
<li><a class="" href="tutorial-for-pull-request-mergers.html"><span class="header-section-number">138</span> Tutorial for pull request mergers</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/jtr13/cc21fall2">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="a-step-by-step-tutorial-for-natural-language-processing-in-r" class="section level1">
<h1>
<span class="header-section-number">75</span> A Step by Step Tutorial for Natural Language Processing in R<a class="anchor" aria-label="anchor" href="#a-step-by-step-tutorial-for-natural-language-processing-in-r"><i class="fas fa-link"></i></a>
</h1>
<p>Yuwen Zhang</p>
<p>Natural language processing (NLP) is an intersection of linguistics, computer science, and artificial intelligence aiming to tackle the interactions between computers and human language, particularly how to program computers to process and analyze large amounts of natural language data. The goal is to train the computer so that it can “understand” the contents of documents, including the contextual nuances of the language within them.</p>
<p>This document contains a short tutorial to perform NLP. It provides a general idea of steps that should be taken when dealing with natural language data.</p>
<p>I use a dataset of reviews on Rotten Tomatoes (<a href="https://www.rottentomatoes.com/" class="uri">https://www.rottentomatoes.com/</a>) as a demo. Our goal is to predict whether a review type is “Fresh” or “Rotten” based on the review content.</p>
<p><br><br></p>
<div id="step-0-exploratory-analysis" class="section level4">
<h4>
<span class="header-section-number">75.0.0.1</span> Step 0 Exploratory Analysis<a class="anchor" aria-label="anchor" href="#step-0-exploratory-analysis"><i class="fas fa-link"></i></a>
</h4>
<p>Before the first step of the NLP analysis, it’s often a good idea to perform exploratory analysis on the dataset to get a general idea of the data that we are working with, such as the distribution of values of each feature, missingness, etc. For example, for <code>review_type</code>, there is a rough 9:5 ratio of Fresh:Rotten, and a 5.8% of empty reviews for <code>review_content</code>.</p>
<p>** In order to speed up the process, I randomly sampled 40,000 reviews for the analysis</p>
<div class="sourceCode" id="cb927"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reviews</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html">unz</a></span><span class="op">(</span><span class="st">"resources/short_guide_for_NLP/rotten_tomatoes_critic_reviews.csv.zip"</span>,
                       <span class="st">"rotten_tomatoes_critic_reviews.csv"</span><span class="op">)</span>,
                   colClasses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NULL"</span>, <span class="st">"NULL"</span>, <span class="st">"NULL"</span>, <span class="st">"NULL"</span>, <span class="cn">NA</span>, <span class="st">"NULL"</span>, <span class="st">"NULL"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>

<span class="va">reviews</span><span class="op">$</span><span class="va">review_val</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html">ifelse</a></span><span class="op">(</span><span class="va">reviews</span><span class="op">$</span><span class="va">review_type</span> <span class="op">==</span> <span class="st">"Fresh"</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">reviews</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">review_type</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##   review_type      n
## 1       Fresh 720210
## 2      Rotten 409807</code></pre>
<div class="sourceCode" id="cb929"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">empty_count</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">reviews</span><span class="op">$</span><span class="va">review_content</span> <span class="op">==</span> <span class="st">""</span><span class="op">)</span>
<span class="va">empty_ratio</span> <span class="op">=</span> <span class="va">empty_count</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">reviews</span><span class="op">)</span>
<span class="va">empty_table</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"Empty_Count"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">empty_count</span><span class="op">)</span>, <span class="st">"Empty_Ratio"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">empty_ratio</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">empty_table</span><span class="op">)</span></code></pre></div>
<pre><code>##   Empty_Count Empty_Ratio
## 1       65806  0.05823452</code></pre>
<div class="sourceCode" id="cb931"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="va">reviews_sample</span> <span class="op">=</span> <span class="va">reviews</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">review_content</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op">(</span><span class="fl">40000</span><span class="op">)</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">reviews_sample</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="5%">
<col width="88%">
<col width="5%">
</colgroup>
<thead><tr class="header">
<th align="left">review_type</th>
<th align="left">review_content</th>
<th align="right">review_val</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Fresh</td>
<td align="left">The effects are good and fans should enjoy some healthy gore.</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Fresh</td>
<td align="left">Although true fans of old-style kung fu movies will love The Protector, the uninitiated may be put off by the movie’s slipshod editing, the waxworks acting and the confusing story.</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Rotten</td>
<td align="left">As usual with Breillat, not much happens outside the boudoir.</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Fresh</td>
<td align="left">Vigo captured the splendor of life itself.</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Fresh</td>
<td align="left">A career-defining role for (Toby) Jones, one that will wither beneath the shadow of Philip Seymour Hoffman’s Oscar-winning turn.</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Rotten</td>
<td align="left">When pointless movies like this come out, I can’t help but wonder what these talented artists could have been doing besides earning this paycheck.</td>
<td align="right">0</td>
</tr>
</tbody>
</table></div>
<p><br><br></p>
</div>
<div id="step-1-data-cleaning" class="section level4">
<h4>
<span class="header-section-number">75.0.0.2</span> Step 1 Data Cleaning<a class="anchor" aria-label="anchor" href="#step-1-data-cleaning"><i class="fas fa-link"></i></a>
</h4>
<p>Usually the data we have on hand is not standardized enough to directly perform training, therefore it is necessary to clean the data first, such as lowercase the words (such as “Hello”, “hello”, “hELLo” to “hello”), remove irrelevant characters (such as “this - that” to “this that”), lemmatize the words (such as “am”, “are”, and “is” to a common form “be”), etc. However, we need to be smart about our approach, there are some questions to consider during my experience of NLP</p>
<ol style="list-style-type: decimal">
<li><p>Lowercase the words: Do we need to lowercase all words? Especially in the case of sentiment analysis, will specific capitalization reveal more information on the sentiment? For example, “what is this movie” may only mean a question, but “WHAT IS THIS MOVIE” may convey a stronger emotion such as upset or confused.</p></li>
<li><p>Remove irrelevant characters: What characters are we considering. For example, periods (.) or commas (,) in a sentence maybe irrelevant for analysis, but what about question marks (?) or exclamation marks (!)? Does “I don’t like this movie.” vs. “I don’t like this movie!” convey the same magnitude of emotion?</p></li>
<li><p>The interaction of words is also something to consider. For example, “it is good” versus “it is not good” both have “good” in the sentence but have completely opposite meanings, because “not” is interacting with “good” in the second sentence.</p></li>
</ol>
<p>For this tutorial, I replace contraction words to their original form (such as I’m to I am, Don’t to Do not), remove all characters except for question marks and exclamation marks, lowercase all words except for words that are completely capitalized and have length &gt; 1 (to exclude words like I or A), and add interaction term to ‘not’ and its following word (for example, if we have “it is not good”, the formatted sentence would be “it is not good notgood”), and lemmatize all words.</p>
<div class="sourceCode" id="cb932"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reviews_sample</span><span class="op">$</span><span class="va">review_content</span> <span class="op">=</span> <span class="fu">replace_contraction</span><span class="op">(</span><span class="va">reviews_sample</span><span class="op">$</span><span class="va">review_content</span><span class="op">)</span>
<span class="va">reviews_sample</span><span class="op">$</span><span class="va">review_content</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"[^A-Za-z0-9 !?]"</span>,<span class="st">""</span>, <span class="va">reviews_sample</span><span class="op">$</span><span class="va">review_content</span><span class="op">)</span>
<span class="va">reviews_sample</span><span class="op">$</span><span class="va">review_content</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"([!?])"</span>, <span class="st">" \\1 \\2"</span>, <span class="va">reviews_sample</span><span class="op">$</span><span class="va">review_content</span><span class="op">)</span>

<span class="va">reviews_sample</span> <span class="op">=</span> <span class="va">reviews_sample</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">review_content</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">reviews_sample</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">review_content</span> <span class="op">=</span> <span class="va">reviews_sample</span><span class="op">$</span><span class="va">review_content</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">review_split</span> <span class="op">=</span>  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/tstrsplit.html">strsplit</a></span><span class="op">(</span><span class="va">review_content</span>, <span class="st">" +"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
  <span class="va">len</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">review_split</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">len</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">review_split</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span><span class="op">(</span><span class="va">review_split</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">review_split</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">review_split</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="va">review_split</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>
    <span class="op">}</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">len</span> <span class="op">&gt;</span> <span class="fl">1</span> <span class="op">&amp;&amp;</span> <span class="va">j</span> <span class="op">&gt;</span> <span class="fl">1</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="va">review_split</span><span class="op">[</span><span class="va">j</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">==</span> <span class="st">"not"</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">review_split</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">review_split</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">review_split</span><span class="op">[</span><span class="va">j</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">review_split</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>
  <span class="op">}</span>
  <span class="va">review_split</span> <span class="op">=</span> <span class="fu">lemmatize_words</span><span class="op">(</span><span class="va">review_split</span><span class="op">)</span>
  <span class="va">reviews_sample</span><span class="op">$</span><span class="va">review_content</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">review_split</span>, collapse<span class="op">=</span><span class="st">' '</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><br><br></p>
</div>
<div id="step-2-data-transformation" class="section level4">
<h4>
<span class="header-section-number">75.0.0.3</span> Step 2 Data Transformation<a class="anchor" aria-label="anchor" href="#step-2-data-transformation"><i class="fas fa-link"></i></a>
</h4>
<p>After cleaning the dataset, the next thing is to process the data so that we can feed it into our model. The first thing is to split our data into training, and testing dataset. Then we need to transform our dataset. Currently our dataset contains only strings, but that’s unhelpful for training. Therefore, we need to represent the data in another format.
One way to do that is using One-hot Encoding (Bag of Words), which is to encode each character individually as a number. For example, if we have two strings “i am correct am i” (STRING 1) and “i am better than her” (STRING 2), then our bag of words would be {“i”, “am”, “correct”, “better”, “than”, “her”} and our dataframe can be converted to what we called a Document-Term Matrix (DTM):</p>
<pre><code>                 "i"       "am"       "correct"       "better"        "than"        "her"
    STRING 1      2          2             1               0             0             0
    STRING 2      1          1             0               1             1             1</code></pre>
<p>This format will be more convenient for model building.</p>
<p>After this step, it is enough to proceed to training. However, we can transform our dataset even more.
One important thing to consider is the frequency of words within one category versus all categories. Our goal here is basically to find words that can uniquely represent each category, therefore, words like “is”, “movie”, “and” are probably present in all categories, making them bad indicators, but words like “good”, “love”, “excellent” are more unique to the “Fresh” category and “bad”, “terrible”, “hate” are more indicative of the “Rotten” category. To better reflect this, we can perform a TF-IDF calculation to the words. tf–idf, TF*IDF, or TFIDF, short for term frequency–inverse document frequency, is a numerical statistic that is intended to reflect how important a word is to a document in a collection or corpus. Term frequency, tf(t,d), is the frequency of term t, and the inverse document frequency, idf(t,D), is a measure of how much information the word provides, i.e., if it’s common or rare across all documents.</p>
<p>In calculation:</p>
<p><span class="math inline">\({\displaystyle \mathrm {tf} (t,d)={\frac {f_{t,d}}{\sum _{t'\in d}{f_{t',d}}}}}\)</span></p>
<p><span class="math inline">\({\displaystyle \mathrm{idf}(t, D) = \log \frac{N}{|\{d \in D: t \in d\}|}}\)</span>
<br><br>
Then tf–idf is calculated as:</p>
<p><span class="math inline">\({\displaystyle \mathrm {tfidf} (t,d,D)=\mathrm {tf} (t,d)\cdot \mathrm {idf} (t,D)}\)</span></p>
<div class="sourceCode" id="cb934"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">train_test</span> <span class="op">=</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html">initial_split</a></span><span class="op">(</span><span class="va">reviews_sample</span>, prop <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span>
<span class="va">test</span> <span class="op">=</span> <span class="va">train_test</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html">testing</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">train</span> <span class="op">=</span> <span class="va">train_test</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html">training</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">model_tfidf</span> <span class="op">=</span> <span class="va">TfIdf</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>smooth_idf <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">train_tokens</span> <span class="op">=</span> <span class="fu">space_tokenizer</span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">review_content</span>, <span class="st">" "</span><span class="op">)</span>
<span class="va">train_dtm</span> <span class="op">=</span> <span class="fu">create_dtm</span><span class="op">(</span><span class="fu">itoken</span><span class="op">(</span><span class="va">train_tokens</span><span class="op">)</span>, <span class="fu">hash_vectorizer</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">train_tfidf</span> <span class="op">=</span> <span class="va">model_tfidf</span><span class="op">$</span><span class="fu">fit_transform</span><span class="op">(</span><span class="va">train_dtm</span><span class="op">)</span>

<span class="va">test_tokens</span> <span class="op">=</span> <span class="fu">space_tokenizer</span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">review_content</span>, <span class="st">" "</span><span class="op">)</span>
<span class="va">test_dtm</span> <span class="op">=</span> <span class="fu">create_dtm</span><span class="op">(</span><span class="fu">itoken</span><span class="op">(</span><span class="va">test_tokens</span><span class="op">)</span>, <span class="fu">hash_vectorizer</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">test_tfidf</span> <span class="op">=</span> <span class="va">model_tfidf</span><span class="op">$</span><span class="fu">transform</span><span class="op">(</span><span class="va">test_dtm</span><span class="op">)</span></code></pre></div>
<p>To wrap up, we first create DTM for our datasets, and then compute tf–idf of the DTM. However, in real life, we don’t want to perform these steps on the entire dataset, because logically we should not know the information of validation and testing data. To prevent such leakage, we perform fit_transform on our training data and transform on the validation and testing data, such that the validation and testing data are being transformed not based on their own information, but the information from the training data.</p>
<p><br><br></p>
</div>
<div id="step-3-hyperparameter-tuning" class="section level4">
<h4>
<span class="header-section-number">75.0.0.4</span> Step 3 Hyperparameter Tuning<a class="anchor" aria-label="anchor" href="#step-3-hyperparameter-tuning"><i class="fas fa-link"></i></a>
</h4>
<p>When fitting the model, we need to find the best parameters so that our model can give the optimal result. In this step, I use glmnet as an example training method (glmnet stands for Lasso and Elastic-Net Regularized Generalized Linear Models, which are extremely efficient procedures for fitting the entire lasso or elastic-net regularization path for linear regression, logistic and multinomial regression models, Poisson regression, Cox model, multiple-response Gaussian, and the grouped multinomial regression. glmnet is also one of the few models that can deal with sparse matrix in R). The parameters that I am tunning are lambdas, and I use cross validation method to find the model with the minimum mean error and its corresponding parameters.</p>
<div class="sourceCode" id="cb935"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lambda_vals</span> <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">2</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">.1</span><span class="op">)</span>
<span class="va">cv_glm_fit</span> <span class="op">=</span> <span class="fu">cv.glmnet</span><span class="op">(</span>x <span class="op">=</span> <span class="va">train_tfidf</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">review_type</span>,
                       family <span class="op">=</span> <span class="st">'binomial'</span>, alpha <span class="op">=</span> <span class="fl">0</span>, lambda <span class="op">=</span> <span class="va">lambda_vals</span>, nfolds <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="va">opt_lambda</span> <span class="op">=</span> <span class="va">cv_glm_fit</span><span class="op">$</span><span class="va">lambda.min</span>


<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Best_lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">opt_lambda</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="right">Best_lambda</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.3162278</td>
</tr></tbody>
</table></div>
<p>As we can see, the best lambda value for that we tuned is around 0.3981</p>
<p><br><br></p>
</div>
<div id="step-4-model-training-evaluation" class="section level4">
<h4>
<span class="header-section-number">75.0.0.5</span> Step 4 Model training &amp; Evaluation<a class="anchor" aria-label="anchor" href="#step-4-model-training-evaluation"><i class="fas fa-link"></i></a>
</h4>
<p>After getting the optimum hyperparameters, we use them to train our model, and predit using our test data.</p>
<div class="sourceCode" id="cb936"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">glm_fit</span> <span class="op">=</span> <span class="va">cv_glm_fit</span><span class="op">$</span><span class="va">glmnet.fit</span>
<span class="va">pred_class</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">glm_fit</span>, s <span class="op">=</span> <span class="va">opt_lambda</span>, newx <span class="op">=</span> <span class="va">test_tfidf</span>, type<span class="op">=</span><span class="st">'class'</span><span class="op">)</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pred_class</span> <span class="op">!=</span> <span class="va">test</span><span class="op">$</span><span class="va">review_type</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="right">accuracy</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.7272</td>
</tr></tbody>
</table></div>
<p>As we can see, we get around 73% correctness with our model, which is not bad!</p>
<p><br><br></p>
</div>
<div id="citation-httpswww.kaggle.comstefanoleone992rotten-tomatoes-movies-and-critic-reviews-dataset" class="section level4">
<h4>
<span class="header-section-number">75.0.0.6</span> Citation: <a href="https://www.kaggle.com/stefanoleone992/rotten-tomatoes-movies-and-critic-reviews-dataset" class="uri">https://www.kaggle.com/stefanoleone992/rotten-tomatoes-movies-and-critic-reviews-dataset</a><a class="anchor" aria-label="anchor" href="#citation-httpswww.kaggle.comstefanoleone992rotten-tomatoes-movies-and-critic-reviews-dataset"><i class="fas fa-link"></i></a>
</h4>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="tutorial-of-three-ggplot2-based-packages.html"><span class="header-section-number">74</span> Tutorial of three ggplot2 based packages</a></div>
<div class="next"><a href="tutorial-for-ggvis-and-its-comparison-with-ggplot2.html"><span class="header-section-number">76</span> Tutorial for ggvis and its Comparison with ggplot2</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav"><li><a class="nav-link" href="#a-step-by-step-tutorial-for-natural-language-processing-in-r"><span class="header-section-number">75</span> A Step by Step Tutorial for Natural Language Processing in R</a></li></ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/jtr13/cc21fall2/blob/main/short_guide_for_NLP.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/jtr13/cc21fall2/edit/main/short_guide_for_NLP.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>EDAV Fall 2021 Tues/Thurs Community Contributions</strong>" was written by . It was last built on 2021-12-28.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
