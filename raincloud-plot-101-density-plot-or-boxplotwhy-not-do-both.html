<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 53 Raincloud plot 101: density plot or boxplot？Why not do both! | EDAV Fall 2021 Tues/Thurs Community Contributions</title>
<meta name="description" content="Jace Yang  53.1 Introduction Remember every time when you analyze a dataset, you are torn between whether density or boxplot is the right one to go? For my EDAV 2021F fellow, you must have thought...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 53 Raincloud plot 101: density plot or boxplot？Why not do both! | EDAV Fall 2021 Tues/Thurs Community Contributions">
<meta property="og:type" content="book">
<meta property="og:description" content="Jace Yang  53.1 Introduction Remember every time when you analyze a dataset, you are torn between whether density or boxplot is the right one to go? For my EDAV 2021F fellow, you must have thought...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 53 Raincloud plot 101: density plot or boxplot？Why not do both! | EDAV Fall 2021 Tues/Thurs Community Contributions">
<meta name="twitter:description" content="Jace Yang  53.1 Introduction Remember every time when you analyze a dataset, you are torn between whether density or boxplot is the right one to go? For my EDAV 2021F fellow, you must have thought...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/forceNetwork-binding-0.4/forceNetwork.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="libs/vis-9.1.0/vis-network.min.js"></script><script src="libs/visNetwork-binding-2.1.0/visNetwork.js"></script><link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet">
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script><script src="libs/dygraphs-1.1.1/shapes.js"></script><script src="libs/moment-2.8.4/moment.js"></script><script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script><script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script><script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script><script src="libs/proj4js-2.3.15/proj4.js"></script><link href="libs/highcharts-8.1.2/css/motion.css" rel="stylesheet">
<script src="libs/highcharts-8.1.2/highcharts.js"></script><script src="libs/highcharts-8.1.2/highcharts-3d.js"></script><script src="libs/highcharts-8.1.2/highcharts-more.js"></script><script src="libs/highcharts-8.1.2/modules/stock.js"></script><script src="libs/highcharts-8.1.2/modules/map.js"></script><script src="libs/highcharts-8.1.2/modules/annotations.js"></script><script src="libs/highcharts-8.1.2/modules/data.js"></script><script src="libs/highcharts-8.1.2/modules/drilldown.js"></script><script src="libs/highcharts-8.1.2/modules/item-series.js"></script><script src="libs/highcharts-8.1.2/modules/offline-exporting.js"></script><script src="libs/highcharts-8.1.2/modules/overlapping-datalabels.js"></script><script src="libs/highcharts-8.1.2/modules/exporting.js"></script><script src="libs/highcharts-8.1.2/modules/export-data.js"></script><script src="libs/highcharts-8.1.2/modules/funnel.js"></script><script src="libs/highcharts-8.1.2/modules/heatmap.js"></script><script src="libs/highcharts-8.1.2/modules/treemap.js"></script><script src="libs/highcharts-8.1.2/modules/sankey.js"></script><script src="libs/highcharts-8.1.2/modules/dependency-wheel.js"></script><script src="libs/highcharts-8.1.2/modules/organization.js"></script><script src="libs/highcharts-8.1.2/modules/solid-gauge.js"></script><script src="libs/highcharts-8.1.2/modules/streamgraph.js"></script><script src="libs/highcharts-8.1.2/modules/sunburst.js"></script><script src="libs/highcharts-8.1.2/modules/vector.js"></script><script src="libs/highcharts-8.1.2/modules/wordcloud.js"></script><script src="libs/highcharts-8.1.2/modules/xrange.js"></script><script src="libs/highcharts-8.1.2/modules/tilemap.js"></script><script src="libs/highcharts-8.1.2/modules/venn.js"></script><script src="libs/highcharts-8.1.2/modules/gantt.js"></script><script src="libs/highcharts-8.1.2/modules/timeline.js"></script><script src="libs/highcharts-8.1.2/modules/parallel-coordinates.js"></script><script src="libs/highcharts-8.1.2/modules/bullet.js"></script><script src="libs/highcharts-8.1.2/modules/coloraxis.js"></script><script src="libs/highcharts-8.1.2/modules/dumbbell.js"></script><script src="libs/highcharts-8.1.2/modules/lollipop.js"></script><script src="libs/highcharts-8.1.2/modules/series-label.js"></script><script src="libs/highcharts-8.1.2/plugins/motion.js"></script><script src="libs/highcharts-8.1.2/custom/reset.js"></script><script src="libs/highcharts-8.1.2/modules/boost.js"></script><script src="libs/highchart-binding-0.8.2/highchart.js"></script><script src="libs/detect-resize-0.5.3/jquery.resize.js"></script><link href="libs/jquery-ui-1.11.4/jquery-ui.min.css" rel="stylesheet">
<script src="libs/jquery-ui-1.11.4/jquery-ui.min.js"></script><script src="libs/vega-1.4.3/vega.min.js"></script><script src="libs/lodash-2.2.1/lodash.min.js"></script><script>var lodash = _.noConflict();</script><link href="libs/ggvis-0.4.7/css/ggvis.css" rel="stylesheet">
<script src="libs/ggvis-0.4.7/js/ggvis.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">EDAV Fall 2021 Tues/Thurs Community Contributions</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome!</a></li>
<li><a class="" href="community-contribution.html"><span class="header-section-number">2</span> Community Contribution</a></li>
<li><a class="" href="github-submission-instructions.html"><span class="header-section-number">3</span> GitHub submission instructions</a></li>
<li><a class="" href="sample-project.html"><span class="header-section-number">4</span> Sample project</a></li>
<li class="book-part">Cheatsheets</li>
<li><a class="" href="statistics-in-r-vs-python.html"><span class="header-section-number">5</span> Statistics in R vs Python</a></li>
<li><a class="" href="data-visualization-with-seaborn.html"><span class="header-section-number">6</span> Data Visualization with Seaborn</a></li>
<li><a class="" href="how-to-make-your-own-r-package.html"><span class="header-section-number">7</span> How to Make Your Own R package</a></li>
<li><a class="" href="rchess-package-cheatsheet.html"><span class="header-section-number">8</span> RChess package cheatsheet</a></li>
<li><a class="" href="hypothesis-testing-cheatsheet.html"><span class="header-section-number">9</span> Hypothesis testing cheatsheet</a></li>
<li><a class="" href="interactive-web-visualizations-for-r-cheatsheet.html"><span class="header-section-number">10</span> Interactive web visualizations for R cheatsheet"</a></li>
<li><a class="" href="ggforce.html"><span class="header-section-number">11</span> ggforce</a></li>
<li><a class="" href="gganimate-cheatsheet.html"><span class="header-section-number">12</span> GGanimate cheatsheet</a></li>
<li><a class="" href="statistical-tests-and-parameter-estimations-in-r-cheatsheet.html"><span class="header-section-number">13</span> Statistical Tests and Parameter Estimations in R Cheatsheet</a></li>
<li><a class="" href="ggalluvial-cheat-sheet.html"><span class="header-section-number">14</span> ggalluvial-cheat-sheet</a></li>
<li><a class="" href="introduction-to-plotly.html"><span class="header-section-number">15</span> Introduction to plotly</a></li>
<li><a class="" href="draw-graphs-using-python-and-r.html"><span class="header-section-number">16</span> draw graphs using python and R</a></li>
<li><a class="" href="data-visualization-packages-in-r.html"><span class="header-section-number">17</span> Data Visualization Packages in R</a></li>
<li><a class="" href="esquisse-cheat-sheet.html"><span class="header-section-number">18</span> Esquisse Cheat sheet</a></li>
<li><a class="" href="review-sheet-for-r-code-and-data-transformation.html"><span class="header-section-number">19</span> review sheet for r code and data transformation</a></li>
<li><a class="" href="scrape-twitter-data-using-r.html"><span class="header-section-number">20</span> Scrape Twitter data using R</a></li>
<li><a class="" href="r-note-and-mathematics-in-rmd-cheatsheet.html"><span class="header-section-number">21</span> R note and Mathematics in Rmd cheatsheet</a></li>
<li><a class="" href="textbook-notes.html"><span class="header-section-number">22</span> Textbook Notes</a></li>
<li><a class="" href="ggplot2-cheatsheet.html"><span class="header-section-number">23</span> ggplot2 cheatsheet</a></li>
<li><a class="" href="rstudio-cheatsheet.html"><span class="header-section-number">24</span> RStudio Cheatsheet</a></li>
<li><a class="" href="d3-visualization-in-r-cheatsheet.html"><span class="header-section-number">25</span> D3 Visualization in R Cheatsheet</a></li>
<li><a class="" href="colors.html"><span class="header-section-number">26</span> Colors</a></li>
<li><a class="" href="r-data-sets.html"><span class="header-section-number">27</span> R data sets</a></li>
<li><a class="" href="introduction-to-plotly-1.html"><span class="header-section-number">28</span> “Introduction to Plotly”</a></li>
<li><a class="" href="tidyverse-cheatsheet.html"><span class="header-section-number">29</span> Tidyverse Cheatsheet</a></li>
<li><a class="" href="learning-sql-with-its-r-dplyr-translation.html"><span class="header-section-number">30</span> Learning SQL with Its R dplyr Translation</a></li>
<li><a class="" href="animate-time-series-the-goyav-package.html"><span class="header-section-number">31</span> Animate Time Series : the goyav package</a></li>
<li><a class="" href="string-manipulation-in-r.html"><span class="header-section-number">32</span> String Manipulation in R</a></li>
<li><a class="" href="ggalluvial-cheatsheet.html"><span class="header-section-number">33</span> ggalluvial Cheatsheet</a></li>
<li><a class="" href="a-cheatsheet-from-pandas-to-base-r-and-tidyverse.html"><span class="header-section-number">34</span> A cheatsheet from pandas to base r and tidyverse</a></li>
<li><a class="" href="base-r-ggplot2-python-graphing-performances.html"><span class="header-section-number">35</span> Base R, ggplot2, &amp; Python Graphing Performances</a></li>
<li><a class="" href="cheat-sheet-to-score-100-points.html"><span class="header-section-number">36</span> Cheat Sheet to Score 100 Points</a></li>
<li><a class="" href="base-r-string-operations-cheatsheet.html"><span class="header-section-number">37</span> Base R String Operations Cheatsheet</a></li>
<li><a class="" href="data-manipulation-in-r.html"><span class="header-section-number">38</span> Data manipulation in R</a></li>
<li><a class="" href="ggplot_matplotlib_cheatsheet.html"><span class="header-section-number">39</span> ggplot_matplotlib_cheatsheet</a></li>
<li><a class="" href="introduction-to-log-transformation.html"><span class="header-section-number">40</span> Introduction to Log-transformation</a></li>
<li class="book-part">Tutorials</li>
<li><a class="" href="how-to-integrate-r-with-postgresql.html"><span class="header-section-number">41</span> How to Integrate R with PostgreSQL</a></li>
<li><a class="" href="tutorial-on-cluster-analysis.html"><span class="header-section-number">42</span> Tutorial on Cluster Analysis</a></li>
<li><a class="" href="apply-function-in-r.html"><span class="header-section-number">43</span> Apply function in r</a></li>
<li><a class="" href="introduction-to-interactive-graphs-in-r.html"><span class="header-section-number">44</span> Introduction to interactive graphs in R</a></li>
<li><a class="" href="plot-and-analyze-stock-data-with-r.html"><span class="header-section-number">45</span> Plot and Analyze Stock Data with R</a></li>
<li><a class="" href="data-visulization-ordering.html"><span class="header-section-number">46</span> Data Visulization Ordering</a></li>
<li><a class="" href="tutorial-on-lattice-package-in-r.html"><span class="header-section-number">47</span> Tutorial on lattice package in R</a></li>
<li><a class="" href="network-visualization-in-r.html"><span class="header-section-number">48</span> Network Visualization in R</a></li>
<li><a class="" href="dplyr-tutorial-in-r.html"><span class="header-section-number">49</span> Dplyr tutorial in R</a></li>
<li><a class="" href="downloading-files.html"><span class="header-section-number">50</span> Downloading files</a></li>
<li><a class="" href="video-introduction-to-maps-with-ggmap.html"><span class="header-section-number">51</span> Video introduction to maps with ggmap</a></li>
<li><a class="" href="comparison-among-base-r-tidyverse-and-datatable.html"><span class="header-section-number">52</span> Comparison among base R, tidyverse, and datatable</a></li>
<li><a class="active" href="raincloud-plot-101-density-plot-or-boxplotwhy-not-do-both.html"><span class="header-section-number">53</span> Raincloud plot 101: density plot or boxplot？Why not do both!</a></li>
<li><a class="" href="an-introduction-to-dygraph-in-r.html"><span class="header-section-number">54</span> An Introduction to Dygraph in R</a></li>
<li><a class="" href="streamlit-tutorial.html"><span class="header-section-number">55</span> Streamlit Tutorial</a></li>
<li><a class="" href="hive-plots-with-the-ggraph-and-hiver-packages.html"><span class="header-section-number">56</span> Hive plots with the ggraph and hiver packages</a></li>
<li><a class="" href="introduction-to-xai-explainable-ai-in-r.html"><span class="header-section-number">57</span> Introduction to XAI (Explainable AI) in R</a></li>
<li><a class="" href="tutorial-for-gg_cleveland.html"><span class="header-section-number">58</span> Tutorial for gg_cleveland</a></li>
<li><a class="" href="neural-network-tools-in-r.html"><span class="header-section-number">59</span> Neural network tools in R</a></li>
<li><a class="" href="r-dplyr-vs-python-pandas.html"><span class="header-section-number">60</span> R Dplyr vs Python Pandas</a></li>
<li><a class="" href="readable-plots.html"><span class="header-section-number">61</span> Readable Plots</a></li>
<li><a class="" href="introduction-to-exploratory-spatial-data-analysis-and-visualization-using-qgis.html"><span class="header-section-number">62</span> Introduction to exploratory spatial data analysis and visualization using QGIS</a></li>
<li><a class="" href="data-visualization-in-python-vs-r.html"><span class="header-section-number">63</span> Data Visualization in Python vs R</a></li>
<li><a class="" href="base-r-tutorial.html"><span class="header-section-number">64</span> Base R Tutorial</a></li>
<li><a class="" href="python-altair-visualization-method-tutorial.html"><span class="header-section-number">65</span> Python Altair Visualization Method Tutorial</a></li>
<li><a class="" href="r-to-python-easy-plot.html"><span class="header-section-number">66</span> R to python easy plot</a></li>
<li><a class="" href="introduction-to-models-and-prediction-evaluation.html"><span class="header-section-number">67</span> Introduction to models and prediction evaluation</a></li>
<li><a class="" href="introduction-to-interactive-time-series-visualizations-with-dygraphs-in-r.html"><span class="header-section-number">68</span> Introduction to Interactive Time Series Visualizations with dygraphs in R</a></li>
<li><a class="" href="integrate-r-with-python.html"><span class="header-section-number">69</span> Integrate R with Python</a></li>
<li><a class="" href="python-visualization-tutorial.html"><span class="header-section-number">70</span> Python Visualization Tutorial</a></li>
<li><a class="" href="gganimate-tutorial.html"><span class="header-section-number">71</span> Gganimate Tutorial</a></li>
<li><a class="" href="get-nba-dataset-in-r.html"><span class="header-section-number">72</span> Get NBA dataset in R</a></li>
<li><a class="" href="mtemplates.html"><span class="header-section-number">73</span> Mtemplates</a></li>
<li><a class="" href="introduction-to-time-series-analysis-in-r.html"><span class="header-section-number">74</span> Introduction to Time Series Analysis in R</a></li>
<li><a class="" href="storytelling-with-data.html"><span class="header-section-number">75</span> Storytelling with Data</a></li>
<li><a class="" href="tutorial-on-r-torch-package.html"><span class="header-section-number">76</span> Tutorial on R torch package</a></li>
<li><a class="" href="edav-tutorials-correlogram-calendar-heatmap-and-slopegram.html"><span class="header-section-number">77</span> EDAV Tutorials: Correlogram, Calendar Heatmap and Slopegram</a></li>
<li><a class="" href="recursive-codes-and-self-organized-map-with-r.html"><span class="header-section-number">78</span> Recursive codes and self-organized map with R</a></li>
<li><a class="" href="tutorial-of-three-ggplot2-based-packages.html"><span class="header-section-number">79</span> Tutorial of three ggplot2 based packages</a></li>
<li><a class="" href="a-step-by-step-tutorial-for-natural-language-processing-in-r.html"><span class="header-section-number">80</span> A Step by Step Tutorial for Natural Language Processing in R</a></li>
<li><a class="" href="tutorial-for-ggvis-and-its-comparison-with-ggplot2.html"><span class="header-section-number">81</span> Tutorial for ggvis and its Comparison with ggplot2</a></li>
<li><a class="" href="feature-selection-in-r.html"><span class="header-section-number">82</span> Feature selection in r</a></li>
<li><a class="" href="debugging-in-rstudio.html"><span class="header-section-number">83</span> Debugging in Rstudio</a></li>
<li><a class="" href="r-tutorial-cheatsheet.html"><span class="header-section-number">84</span> R tutorial cheatsheet</a></li>
<li><a class="" href="brief-introduction-of-ggpubr.html"><span class="header-section-number">85</span> Brief Introduction of ggpubr</a></li>
<li><a class="" href="r-based-data-organization-and-visualization.html"><span class="header-section-number">86</span> R based data organization and visualization</a></li>
<li><a class="" href="r-packages-for-map-visualization.html"><span class="header-section-number">87</span> R packages for map Visualization</a></li>
<li><a class="" href="common-git-command-lines-tutorial-when-working-on-studio.html"><span class="header-section-number">88</span> Common git command lines tutorial when working on studio</a></li>
<li><a class="" href="tutorial-of-radar-chart.html"><span class="header-section-number">89</span> Tutorial of radar chart</a></li>
<li><a class="" href="interactive-radar.html"><span class="header-section-number">90</span> Interactive Radar</a></li>
<li><a class="" href="r-shiny-tutorial.html"><span class="header-section-number">91</span> R shiny tutorial</a></li>
<li><a class="" href="tutorial-on-r-markdown.html"><span class="header-section-number">92</span> Tutorial on R Markdown</a></li>
<li><a class="" href="dlookr-package.html"><span class="header-section-number">93</span> Dlookr package</a></li>
<li><a class="" href="urca-unit-root-test-and-cointegration-test.html"><span class="header-section-number">94</span> Urca: Unit Root Test and Cointegration Test</a></li>
<li><a class="" href="pygal-tutorial.html"><span class="header-section-number">95</span> pygal tutorial</a></li>
<li><a class="" href="comparing-excel-chart-making-with-rs.html"><span class="header-section-number">96</span> Comparing Excel Chart Making with R’s</a></li>
<li><a class="" href="joining-and-reshaping-in-r.html"><span class="header-section-number">97</span> Joining and reshaping in R</a></li>
<li><a class="" href="running-sql-queries-on-dataframes.html"><span class="header-section-number">98</span> Running Sql Queries on Dataframes</a></li>
<li><a class="" href="tidyverse.html"><span class="header-section-number">99</span> TidyVerse</a></li>
<li><a class="" href="how-to-animate-your-plots.html"><span class="header-section-number">100</span> How to animate your plots</a></li>
<li><a class="" href="dataframe-operations-tutorial.html"><span class="header-section-number">101</span> Dataframe operations tutorial</a></li>
<li><a class="" href="a-brief-instruction-for-the-half-semester-of-edav5702.html"><span class="header-section-number">102</span> A brief instruction for the half semester of EDAV5702</a></li>
<li><a class="" href="ggplot2-in-python.html"><span class="header-section-number">103</span> ggplot2 in python</a></li>
<li><a class="" href="predictive-analytics-using-data-visualization-in-r.html"><span class="header-section-number">104</span> Predictive Analytics using Data Visualization in R</a></li>
<li><a class="" href="color-selection-for-ggplot-graphs.html"><span class="header-section-number">105</span> Color selection for ggplot graphs</a></li>
<li class="book-part">Project &amp; Workshops</li>
<li><a class="" href="introduction-to-analytics-consulting-at-accenture.html"><span class="header-section-number">106</span> Introduction to analytics consulting at Accenture</a></li>
<li><a class="" href="map-of-the-r-world.html"><span class="header-section-number">107</span> Map of the R world</a></li>
<li><a class="" href="alluvial-diagrams-and-their-implementation-using-ggalluvial-in-r.html"><span class="header-section-number">108</span> Alluvial diagrams and their implementation using GGalluvial in R</a></li>
<li><a class="" href="building-a-dashboard-in-r-for-data-analysis-and-visualization-using-shiny-package.html"><span class="header-section-number">109</span> Building a Dashboard in R for Data Analysis and Visualization using shiny package</a></li>
<li><a class="" href="rgl-package.html"><span class="header-section-number">110</span> RGL Package</a></li>
<li class="book-part">Data Visualization</li>
<li><a class="" href="an-introduction-to-pyecharts-package-in-python.html"><span class="header-section-number">111</span> An introduction to pyecharts package in Python</a></li>
<li><a class="" href="visualization-in-r-v.s.-python.html"><span class="header-section-number">112</span> Visualization in R v.s. Python</a></li>
<li><a class="" href="understand-data-with-plots.html"><span class="header-section-number">113</span> Understand data with plots</a></li>
<li><a class="" href="r-and-python-visualization.html"><span class="header-section-number">114</span> R and Python visualization</a></li>
<li><a class="" href="d-visualization-with-rgl-and-scatterplot3d.html"><span class="header-section-number">115</span> 3D Visualization with rgl and scatterplot3d</a></li>
<li><a class="" href="base-r-vs.-ggplot2-visualization.html"><span class="header-section-number">116</span> Base r vs. ggplot2 visualization</a></li>
<li class="book-part">Custom R Package</li>
<li><a class="" href="super-ggformat.html"><span class="header-section-number">117</span> Super ggformat</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="github-initial-setup.html"><span class="header-section-number">118</span> Github initial setup</a></li>
<li><a class="" href="tutorial-for-pull-request-mergers.html"><span class="header-section-number">119</span> Tutorial for pull request mergers</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/jtr13/cc21fall2">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="raincloud-plot-101-density-plot-or-boxplotwhy-not-do-both" class="section level1">
<h1>
<span class="header-section-number">53</span> Raincloud plot 101: density plot or boxplot？Why not do both!<a class="anchor" aria-label="anchor" href="#raincloud-plot-101-density-plot-or-boxplotwhy-not-do-both"><i class="fas fa-link"></i></a>
</h1>
<p>Jace Yang</p>
<div id="introduction-7" class="section level2">
<h2>
<span class="header-section-number">53.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-7"><i class="fas fa-link"></i></a>
</h2>
<p>Remember every time when you analyze a dataset, you are torn between whether density or boxplot is the right one to go? For my EDAV 2021F fellow, you must have thought about that for a while in the Q5 of our HW1, the one we are asked to compare which the following one is better.</p>
<div class="sourceCode" id="cb639"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">loans_full_schema</span> <span class="op">%&lt;&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>loan_purpose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">loan_purpose</span>, <span class="va">loan_amount</span>, FUN <span class="op">=</span> <span class="va">median</span><span class="op">)</span><span class="op">)</span> 
<span class="va">JACE_COLOR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#FF5A5F"</span>, <span class="st">"#FFB400"</span>, <span class="st">"#007A87"</span>, 
                 <span class="st">"#8CE071"</span>, <span class="st">"#7B0051"</span>, <span class="st">"#00D1C1"</span>, <span class="st">"#FFAA91"</span>, <span class="st">"#B4A76C"</span>, 
                 <span class="st">"#9CA299"</span>, <span class="st">"#565A5C"</span>, <span class="st">"#00A04B"</span>, <span class="st">"#E54C20"</span><span class="op">)</span>

<span class="va">loans_full_schema</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">loan_purpose</span>,
      x <span class="op">=</span> <span class="va">loan_amount</span>,
      fill <span class="op">=</span> <span class="va">loan_purpose</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span>
  <span class="va">theme_jace</span> <span class="op">+</span>
  <span class="va">only_x</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">JACE_COLOR</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"HW1 (5)b. Create horizontal boxplots of loan_amount, one for each level of loan_purpose"</span>,
       subtitle <span class="op">=</span> <span class="st">"Use loans_full_schema data from in openintro package"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">breaks_width</span><span class="op">(</span><span class="fl">5000</span><span class="op">)</span>, labels <span class="op">=</span> <span class="va">axis_unit_scaler</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">p1</span>

<span class="va">loans_full_schema</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">loan_amount</span>, 
      y <span class="op">=</span> <span class="va">loan_purpose</span>, 
      fill <span class="op">=</span> <span class="va">loan_purpose</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_density_ridges2</span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span>
  <span class="va">theme_jace</span> <span class="op">+</span>
  <span class="va">only_x</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"HW1 (5)c. Create ridgeline plots for the same data as in b)."</span>,
       subtitle <span class="op">=</span> <span class="st">"Use loans_full_schema data from in openintro package"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">breaks_width</span><span class="op">(</span><span class="fl">5000</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>  <span class="op">-&gt;</span> <span class="va">p2</span>

<span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></code></pre></div>
<div class="inline-figure"><img src="raincloud_plot_tutorial_files/figure-html/unnamed-chunk-2-1.png" width="1248" style="display: block; margin: auto;"></div>
<p>The guidance solution below suggests that we should choose ridgeline plots because density reveals more information.</p>
<hr>
<p><mark> The high loan amounts of $40,000 are easier to see using the boxplots in part b. However, the ridgelines in part c allow us to see the distributions of the data</mark>, which gives us some interesting insight. For instance small business loans are essentially uniformly distributed from $10,000 to $40,000, with a bump at $40,000. Renewable energy loans are tri-modal, with modes at $10,000, $27,500, and $40,000. These modes and bumps are lost in the boxplots, as you cannot tell how many outliers there are at a specific loan amount. This goes along with the insight from part a, where we could see the majority of loans were multiples of $5,000.</p>
<hr>
<p>However, as mentioned in the highlighted sentence, boxplots are also useful for determining the variable’s actual maximum:</p>
<div class="sourceCode" id="cb640"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">loans_full_schema</span><span class="op">$</span><span class="va">loan_amount</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 40000</code></pre>
<p>Aside from that, I believe boxplots have its own set of useful features in this case as well.</p>
<ul>
<li><p>It clearly displays the median ranking as well as the differences between them. Even when I rank the density plots in the Ridgeline plots, it is very difficult to identify which groups have bigger loan amounts on median or they are the same.</p></li>
<li><p>While the Ridgeline plot allows us to compare the distribution of a few variables, it is unnecessarily detailed due to the fact that this category variable contains more than 10 examples. A box plot offers a lot of information at a glance by interquatile range.</p></li>
</ul>
<p>However, there is a way to combine boxplot and ridgeline(density) plots together, using the raincloud plot:</p>
<div class="sourceCode" id="cb642"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">loans_full_schema</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">loan_purpose</span>,
      y <span class="op">=</span> <span class="va">loan_amount</span>,
      fill <span class="op">=</span> <span class="va">loan_purpose</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">loan_purpose</span><span class="op">)</span>,
             position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span>,
             size <span class="op">=</span> <span class="fl">0.5</span>,
             alpha <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.24</span>,
               outlier.shape <span class="op">=</span> <span class="cn">NA</span>,
               alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_flat_violin</span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span>,
                   trim <span class="op">=</span> <span class="cn">TRUE</span>, 
                   alpha <span class="op">=</span> <span class="fl">0.7</span>, 
                   scale <span class="op">=</span> <span class="st">"width"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">breaks_width</span><span class="op">(</span><span class="fl">5000</span><span class="op">)</span>, label <span class="op">=</span> <span class="va">axis_unit_scaler</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">JACE_COLOR</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">JACE_COLOR</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>,
       title <span class="op">=</span> <span class="st">"Raincloud Plot of loan amount for 11 different loan purpose"</span><span class="op">)</span> <span class="op">+</span>
  <span class="va">theme_jace</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
  <span class="va">only_x</span></code></pre></div>
<div class="inline-figure"><img src="raincloud_plot_tutorial_files/figure-html/unnamed-chunk-4-1.png" width="1248" style="display: block; margin: auto;"></div>
<p>Now, you can not only see the density shape from the ridges, statistics from the boxplots, but also a scatter plot that informs us that loan amounts are predominantly multiples of $5,000, such as $35,000 and $40,000, which is the conclusion we are expected to get in 5. a)!</p>
<p>Without further ado, lets break it down and see how it is created!</p>
</div>
<div id="components-of-raincloud-plot." class="section level2">
<h2>
<span class="header-section-number">53.2</span> Components of raincloud plot.<a class="anchor" aria-label="anchor" href="#components-of-raincloud-plot."><i class="fas fa-link"></i></a>
</h2>
<p>In this section, I will use the variable <code>verified_income</code> with less cardinality to demonstrate one way to generate raincloud plot:</p>
<div class="sourceCode" id="cb643"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">loans_full_schema</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">verified_income</span>, <span class="va">loan_amount</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 10,000 × 2
##    verified_income loan_amount
##    &lt;fct&gt;                 &lt;int&gt;
##  1 Verified              28000
##  2 Not Verified           5000
##  3 Source Verified        2000
##  4 Not Verified          21600
##  5 Verified              23000
##  6 Not Verified           5000
##  7 Source Verified       24000
##  8 Source Verified       20000
##  9 Source Verified       20000
## 10 Not Verified           6400
## # … with 9,990 more rows</code></pre>
<p><strong>Essentially, raincloud plot is just a halved <code>violin</code> + jittered <code>point</code> + <code>boxplot</code> visulization combo.</strong></p>
<div id="tailoring-out-the-cloud-halved-violin" class="section level3">
<h3>
<span class="header-section-number">53.2.1</span> Tailoring out the cloud: halved violin<a class="anchor" aria-label="anchor" href="#tailoring-out-the-cloud-halved-violin"><i class="fas fa-link"></i></a>
</h3>
<p>Remind that violin plot is cool but wasting half the space. Because it is symmetric and both half are saying the same thing! So, the first thing we we’d like to do is to cut it half! The simplest way I know is using <a href="https://rdrr.io/github/samhforbes/PupillometryR/man/geom_flat_violin.html">geom_flat_violin</a> from the <code>PupillometryR</code> pacakge.</p>
<div class="sourceCode" id="cb645"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">loans_full_schema</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">verified_income</span>,
      y <span class="op">=</span> <span class="va">loan_amount</span>,
      fill <span class="op">=</span> <span class="va">verified_income</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_flat_violin</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="raincloud_plot_tutorial_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></div>
<blockquote>
<p>Note that geom_flat_violin automatically enable <code>trim = TRUE</code> so it allows us to see the real min and max by default!</p>
</blockquote>
<p>Sometimes a vertical raincloud plot is better in case you are visualizing high-cardinality variable and hope to keep it wide yet short in your paper (I will show you in the next section!). But for now, lets make it look more like a “cloud” first by flipping it!</p>
<div class="sourceCode" id="cb646"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">loans_full_schema</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">verified_income</span>,
      y <span class="op">=</span> <span class="va">loan_amount</span>,
      fill <span class="op">=</span> <span class="va">verified_income</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_flat_violin</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># New code added here</span></code></pre></div>
<div class="inline-figure"><img src="raincloud_plot_tutorial_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Now we have the clustered density curve! I looks like the ‘Not Documented’ Status has a larger density skewmess to the left, indicating that applicants without a verified income are more likely to be approved for a smaller loan amount. But it’s hard to read more information from it!</p>
</div>
<div id="making-it-rain-jittered-points" class="section level3">
<h3>
<span class="header-section-number">53.2.2</span> Making it rain: jittered points<a class="anchor" aria-label="anchor" href="#making-it-rain-jittered-points"><i class="fas fa-link"></i></a>
</h3>
<p>Then, creates some “rain”.</p>
<div class="sourceCode" id="cb647"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">loans_full_schema</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">verified_income</span>,
      y <span class="op">=</span> <span class="va">loan_amount</span>,
      fill <span class="op">=</span> <span class="va">verified_income</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_flat_violin</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">verified_income</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># New code added here</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="raincloud_plot_tutorial_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></div>
<p>This doesn’t looks right! Lets move the cloud a little bit higher.</p>
<div class="sourceCode" id="cb648"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">loans_full_schema</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">verified_income</span>,
      y <span class="op">=</span> <span class="va">loan_amount</span>,
      fill <span class="op">=</span> <span class="va">verified_income</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_flat_violin</span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span>, <span class="co"># New code added here</span>
                   alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">verified_income</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="raincloud_plot_tutorial_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></div>
<p>, and make the rain falls:</p>
<div class="sourceCode" id="cb649"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">loans_full_schema</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">verified_income</span>,
      y <span class="op">=</span> <span class="va">loan_amount</span>,
      fill <span class="op">=</span> <span class="va">verified_income</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_flat_violin</span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span>,
                   alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">verified_income</span><span class="op">)</span>,
             position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># New code added here</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="raincloud_plot_tutorial_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Now we have the density as well as the raw data that generated the density curve, which allows us to notice the weird parallel dots. But to better understand the median, quartiles, and outliers of our data, lets add some boxplots above the points!</p>
</div>
<div id="adding-the-box-to-collect-the-rain-boxplot" class="section level3">
<h3>
<span class="header-section-number">53.2.3</span> Adding the box to “collect” the rain: boxplot<a class="anchor" aria-label="anchor" href="#adding-the-box-to-collect-the-rain-boxplot"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb650"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">loans_full_schema</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">verified_income</span>,
      y <span class="op">=</span> <span class="va">loan_amount</span>,
      fill <span class="op">=</span> <span class="va">verified_income</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_flat_violin</span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span>,
                   alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">verified_income</span><span class="op">)</span>,
             position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># New code added here</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="raincloud_plot_tutorial_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Oops, the box is too large! Remember that we already move the density curves higher, thus the only thing left to do now is to make the boxplots smaller. It will remain aligned with the center of the points.</p>
<div class="sourceCode" id="cb651"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">loans_full_schema</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">verified_income</span>,
      y <span class="op">=</span> <span class="va">loan_amount</span>,
      fill <span class="op">=</span> <span class="va">verified_income</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_flat_violin</span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span>,
                   alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">verified_income</span><span class="op">)</span>,
             position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span> <span class="op">+</span> <span class="co"># New code added here</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="raincloud_plot_tutorial_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Awesome! Then let’s apply some magic to it!</p>
</div>
<div id="adjustment" class="section level3">
<h3>
<span class="header-section-number">53.2.4</span> Adjustment<a class="anchor" aria-label="anchor" href="#adjustment"><i class="fas fa-link"></i></a>
</h3>
<p>There are several parameters we can tune to make rain cloud plot looks good!</p>
<ul>
<li>
<p><code>geom_point</code>:</p>
<ul>
<li><p><code>size</code>: the larger the data, the smaller the size of a point should be.</p></li>
<li>
<p><code>alpha</code>: the larger the data, the lighter one data point should set.</p>
<ul>
<li>If there is so many data, pass in <code>data = . %&gt;% sample_frac(0.33)</code> to only include 33% to generate those dots (<code>.</code> is refered to the data you pipe into ggplot()). But only do this sampling inside <code>geom_point</code>!</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>geom_boxplot</code></p>
<ul>
<li>
<p>outlier.shape: I generally turn it off by passing <code>NA</code>, because by raincloud scatter we can distinguish outliers from points that lay outside the boxplot lines.</p>
<ul>
<li>For example, in the last plot above, boxplot shows 3 high outliers at <code>Not Verified</code> class, but <code>geom_point</code> has already plotted and jittered them to indicate that there are many outlieres at <code>loan_amount = 40,000</code>!</li>
</ul>
</li>
<li><p><code>width</code>: the width of boxplot I generally pass in 0.25 and it looks good.</p></li>
<li>
<p><code>alpha</code>: To see the dots below box plot, you have to make it a transparent by setting this or passing in a transparent color to fill scaler.</p>
<ul>
<li>For example, <code>alpha("blue", 0.5)</code> gives you “#0000FF80”, a “80” transparant effect added to blue color).</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>geom_flat_violin</code></p>
<ul>
<li><p><code>scale</code>: default as <code>area</code>,which results in a discernible difference in density between the minority and majority groups. If you already know their difference and simply want to check in-group distribution only, pass in <code>scale = "width"</code>.</p></li>
<li><p><code>alpha</code>: I personally like to make it a little transparent out of aesthetic considerations.</p></li>
<li><p><code>adjust</code>: A multiplicate bandwidth adjustment. For example, <code>adjust = 0.5</code> means use half of the default bandwidth.</p></li>
</ul>
</li>
<li>
<p><code>scaler</code>:</p>
<ul>
<li><p>To change the colors, do in both to fill and color aesthetics! You can pick some colors and put them in <code>scale_color_manual(values = YOUR_COLORS)</code> and <code>scale_color_manual(values = YOUR_COLORS)</code>.</p></li>
<li>
<p><code>scale_y_continuous</code>: you can create more breaks by utilizing <code>scales</code> pacakage. For example,</p>
<ul>
<li><p><code>breaks = breaks_width(5000)</code>: breaks every 5000.</p></li>
<li><p><code>breaks = pretty_breaks(10)</code>: breaks them into about 10 axis.</p></li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>theme</code>:</p>
<ul>
<li>The grid lines in x axis (after flip it becomes y) are now useless! Because x axis contains only differnt categories, and keeping its grid lines will yield unnecessary lines under boxplots.</li>
</ul>
</li>
<li><p>More tips about scale and theme at the final “Additional Tips” section!</p></li>
</ul>
<p>Now lets apply some of these techniques and get a cool chart:</p>
<div class="sourceCode" id="cb652"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">loans_full_schema</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">verified_income</span>,
      y <span class="op">=</span> <span class="va">loan_amount</span>,
      fill <span class="op">=</span> <span class="va">verified_income</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">verified_income</span><span class="op">)</span>,
             position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span>,
             size <span class="op">=</span> <span class="fl">0.5</span>,
             alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.25</span>,
               outlier.shape <span class="op">=</span> <span class="cn">NA</span>,
               alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_flat_violin</span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span>,
                   alpha <span class="op">=</span> <span class="fl">0.7</span>,
                   adjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">breaks_width</span><span class="op">(</span><span class="fl">5000</span><span class="op">)</span>, labels <span class="op">=</span> <span class="va">axis_unit_scaler</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">JACE_COLOR</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">JACE_COLOR</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Type of verification of the applicant's income"</span>,
                             direction <span class="op">=</span> <span class="st">"horizontal"</span>,
                             reverse <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,
         color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Type of verification of the applicant's income"</span>,
                              direction <span class="op">=</span> <span class="st">"horizontal"</span>,
                              reverse <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>,
       title <span class="op">=</span> <span class="st">"Raincloud Plot of loan amount by 3 different verified income status"</span><span class="op">)</span> <span class="op">+</span>
  <span class="va">theme_jace</span> <span class="op">+</span>
  <span class="va">only_x</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">p</span>
<span class="va">p</span></code></pre></div>
<div class="inline-figure"><img src="raincloud_plot_tutorial_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Looks good right? Now we get the full picture of this dataset by:</p>
<ul>
<li><p><strong>Observing the boxplots</strong>: The median of the loan amount is: Verified &gt; Source Verified &gt; Not Verified, with a roughly 3.5k~4k incremental difference.</p></li>
<li><p><strong>Observing the jitter</strong>: The heaping effect occurs in all income verification statuses, and the loan amount appears in numbers of 1000, notably in the multiples of 5,000.</p></li>
<li><p><strong>Observing the density</strong>: For applicants without verified income, the loan amount distribution is unimodal around 10,000.</p></li>
</ul>
<p>Isn’t the data itself is talking in this graph? I know the code is a little bit complicated, but I hope this code and the code in the 1.introduction should begin to make sense to you!</p>
</div>
</div>
<div id="more-examples" class="section level2">
<h2>
<span class="header-section-number">53.3</span> More Examples<a class="anchor" aria-label="anchor" href="#more-examples"><i class="fas fa-link"></i></a>
</h2>
<p>n this section, I organized codes from some of my previous work to provide you more examples! You can select one as a template to create your own! Typically, you can use raincloud plot if you have:</p>
<ul>
<li><p>1 categorical variable, and 1 numerical variable (We already did that!)</p></li>
<li><p>2 categorical variable that 1 is the sub-group splitted from the other, and 1 numerical variable.</p></li>
<li><p>2 Categorical X + Numerical Y</p></li>
<li><p>1 categorical X + 1 numerical X + 1 numerical Y</p></li>
</ul>
<p>Let’s check them out!</p>
<div id="grouped-categorical-x-numerical-y" class="section level3">
<h3>
<span class="header-section-number">53.3.1</span> Grouped Categorical X + Numerical Y<a class="anchor" aria-label="anchor" href="#grouped-categorical-x-numerical-y"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Data preparation</li>
</ol>
<p>The <a href="https://www.kaggle.com/c/m5-forecasting-accuracy/data">Kaggle Walmart sales dataset</a> provides us with 30,000+ “time serieses” of unit sales data from 2011 to 2015, organized hierarchically by store, category, and state.</p>
<p>In the following code, we clean it into the monthly total unit sales grouped by 10 stores in 3 states, and store it into a RData file for you to easily reproduce the plot!</p>
<div class="sourceCode" id="cb653"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># This chunk is not evaled! It just shows my preprocessing steps from a data you can download from https://www.kaggle.com/c/m5-forecasting-accuracy/data</span>
<span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"resources/raincloud_plot_tutorial/sales_train_evaluation.csv"</span>, col_types <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html">cols</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>

  <span class="co"># Calculate monthly mean sales by every store</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">state_id</span>, <span class="va">store_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_at</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"d_"</span><span class="op">)</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"d_"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"dates"</span>, values_to <span class="op">=</span> <span class="st">"sales"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>dates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">dates</span>, <span class="st">"d_"</span><span class="op">)</span><span class="op">)</span>,
         dates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/date.html">date</a></span><span class="op">(</span><span class="st">"2011-01-29"</span><span class="op">)</span> <span class="op">+</span> <span class="va">dates</span> <span class="op">-</span> <span class="fl">1</span>,
         store_id <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">store_id</span>, <span class="st">"_validation|_evaluation"</span><span class="op">)</span>,
         month <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/IDateTime.html">month</a></span><span class="op">(</span><span class="va">dates</span><span class="op">)</span>,
         year <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/IDateTime.html">year</a></span><span class="op">(</span><span class="va">dates</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  
  <span class="co"># Adjust it</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">month</span>, <span class="va">year</span>, <span class="va">state_id</span>, <span class="va">store_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>sales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">sales</span><span class="op">)</span>,
            dates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">dates</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">dates</span><span class="op">)</span>, <span class="st">"..-..-01"</span><span class="op">)</span>,
         <span class="va">dates</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">dates</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span><span class="va">state_id</span>,
            <span class="va">store_id</span>,
            <span class="va">year</span>,
            <span class="va">month</span>,
            <span class="va">sales</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">walmart_monthly_sales</span>
<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">walmart_monthly_sales</span>, file <span class="op">=</span> <span class="st">"resources/raincloud_plot_tutorial/walmart_monthly_sales.RData"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb654"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"resources/raincloud_plot_tutorial/walmart_monthly_sales.RData"</span><span class="op">)</span>
<span class="va">walmart_monthly_sales</span></code></pre></div>
<pre><code>## # A tibble: 630 × 5
##    state_id store_id  year month  sales
##    &lt;chr&gt;    &lt;chr&gt;    &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;
##  1 CA       CA_1      2012     1 106579
##  2 CA       CA_2      2012     1  77786
##  3 CA       CA_3      2012     1 160276
##  4 CA       CA_4      2012     1  58738
##  5 TX       TX_1      2012     1  77448
##  6 TX       TX_2      2012     1 107283
##  7 TX       TX_3      2012     1  80685
##  8 WI       WI_1      2012     1  51901
##  9 WI       WI_2      2012     1  57600
## 10 WI       WI_3      2012     1 115079
## # … with 620 more rows</code></pre>
<ul>
<li>There are 63 months from Jan 2012 to Apr 2016, multiplying by 63 stores give us 630 rows.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Original version</li>
</ol>
<p>This is exactly how we created raincloud plot:</p>
<div class="sourceCode" id="cb656"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">JACE_COLOR_2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#FF5A5F"</span>, <span class="st">"#FFB400"</span>, <span class="st">"#007A87"</span>, 
                 <span class="st">"#8CE071"</span>, <span class="st">"#7B0051"</span>, <span class="st">"#00D1C1"</span>, <span class="st">"#FFAA91"</span>, <span class="st">"#B4A76C"</span>, 
                 <span class="st">"#9CA299"</span>, <span class="st">"#565A5C"</span>, <span class="st">"#00A04B"</span>, <span class="st">"#E54C20"</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">walmart_monthly_sales</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">store_id</span>, 
      y <span class="op">=</span> <span class="va">sales</span>, 
      fill <span class="op">=</span> <span class="va">store_id</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_flat_violin</span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span>, 
                   alpha <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">store_id</span><span class="op">)</span>, 
             position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span>, 
             size <span class="op">=</span> <span class="fl">1</span>,
             alpha <span class="op">=</span> <span class="fl">0.4</span>,
             show.legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.25</span>, 
               outlier.shape <span class="op">=</span> <span class="cn">NA</span>,
               alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">JACE_COLOR_2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">JACE_COLOR_2</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">axis_unit_scaler</span>, breaks <span class="op">=</span> <span class="fu">breaks_width</span><span class="op">(</span><span class="fl">25e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Store ID"</span>,
       y <span class="op">=</span> <span class="st">"Monthly Sales"</span>,
       fill <span class="op">=</span> <span class="st">"Store ID: "</span>,
       title <span class="op">=</span> <span class="st">"Raincloud plot of Walmart monthly sales from 10 stores in 3 states"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>nrow<span class="op">=</span><span class="fl">1</span>,
                             byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="va">theme_jace</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,
        legend.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="raincloud_plot_tutorial_files/figure-html/unnamed-chunk-16-1.png" width="768" style="display: block; margin: auto;"></div>
<p>It looks okay, but note that the color we filled in to the boxplot and density curve is redundant since the store_id is already mapped to the x axis! This is exactly the case that if you find the legend unnecessary, probably the aesthetic it represents as well.</p>
<ol start="3" style="list-style-type: decimal">
<li>Better prectice</li>
</ol>
<p>A better way is to map the fill to the “parent” group of <code>store_id</code>, the <code>state_id</code>!</p>
<div class="sourceCode" id="cb657"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">walmart_monthly_sales</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">store_id</span>, 
     y <span class="op">=</span> <span class="va">sales</span>, 
     fill <span class="op">=</span> <span class="va">state_id</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Code changed here</span>
  <span class="fu">geom_flat_violin</span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span>, 
                   alpha <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">state_id</span><span class="op">)</span>, 
             position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span>, 
             size <span class="op">=</span> <span class="fl">1</span>,
             alpha <span class="op">=</span> <span class="fl">0.4</span>,
             show.legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.25</span>, 
               outlier.shape <span class="op">=</span> <span class="cn">NA</span>,
               alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">JACE_COLOR_2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">JACE_COLOR_2</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">axis_unit_scaler</span>, breaks <span class="op">=</span> <span class="fu">breaks_width</span><span class="op">(</span><span class="fl">25e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Store id"</span>,
       y <span class="op">=</span> <span class="st">"Monthly Sales"</span>,
       fill <span class="op">=</span> <span class="st">"State Name: "</span>,
       title <span class="op">=</span> <span class="st">"Raincloud plot of Walmart monthly sales from 10 stores in 3 states"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>nrow<span class="op">=</span><span class="fl">1</span>,
                             byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="va">theme_jace</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,
        legend.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="raincloud_plot_tutorial_files/figure-html/unnamed-chunk-17-1.png" width="768" style="display: block; margin: auto;"></div>
<ul>
<li>The color contains the state information now!</li>
</ul>
</div>
<div id="categorical-x1-numerical-x2-numerical-y" class="section level3">
<h3>
<span class="header-section-number">53.3.2</span> Categorical X1 + Numerical X2 + Numerical Y<a class="anchor" aria-label="anchor" href="#categorical-x1-numerical-x2-numerical-y"><i class="fas fa-link"></i></a>
</h3>
<p>The <a href="https://archive.ics.uci.edu/ml/datasets/bank+marketing">UCI Bank Marketing dataset</a> provides us with population characteristics of the object of a marketing campaign from a Portuguese financial institution, as well as whether it was successful as its binary target label.</p>
<div class="sourceCode" id="cb658"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># This chunk is not evaled! It just shows my preprocessing steps from `bank-additional-full.csv` that I downloaded from https://archive.ics.uci.edu/ml/machine-learning-databases/00222/</span>
<span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span><span class="st">"resources/raincloud_plot_tutorial/bank-additional-full.csv"</span>, <span class="st">";"</span>, 
           escape_double <span class="op">=</span> <span class="cn">FALSE</span>, 
           trim_ws <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>education <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">education</span>, 
                            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"illiterate"</span>, <span class="st">"basic.4y"</span>, <span class="st">"basic.6y"</span>,
                                       <span class="st">"basic.9y"</span>, <span class="st">"high.school"</span>, <span class="st">"university.degree"</span>, 
                                       <span class="st">"professional.course"</span>, <span class="st">"unknown"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
                       <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="st">"unknown"</span>, after <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>,
         job <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">job</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="st">"unknown"</span>, after <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>result <span class="op">=</span> <span class="va">y</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">education</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">job</span>, <span class="va">education</span>, <span class="va">age</span>, <span class="va">result</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">bank</span>
<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">bank</span>, file <span class="op">=</span> <span class="st">"resources/raincloud_plot_tutorial/bank.RData"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb659"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"resources/raincloud_plot_tutorial/bank.RData"</span><span class="op">)</span>
<span class="va">bank</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">job</span><span class="op">:</span><span class="va">education</span>,
               names_to <span class="op">=</span> <span class="st">"variable"</span>,
               values_to <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">class</span>, levels <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">bank</span><span class="op">$</span><span class="va">education</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">bank</span><span class="op">$</span><span class="va">job</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
           <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="st">"unknown"</span>, after <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>,
         result <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">result</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"yes"</span>, <span class="st">"no"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
           <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode</a></span><span class="op">(</span>sucess <span class="op">=</span> <span class="st">"yes"</span>, fail <span class="op">=</span> <span class="st">"no"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">class</span>,
      y <span class="op">=</span> <span class="va">age</span>,
      fill <span class="op">=</span> <span class="va">result</span><span class="op">)</span> <span class="op">+</span> <span class="co">#</span>
  <span class="fu">geom_flat_violin</span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span>, 
                   alpha <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">result</span><span class="op">)</span>, 
             position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitterdodge.html">position_jitterdodge</a></span><span class="op">(</span>jitter.width <span class="op">=</span> <span class="fl">.15</span>, <span class="co"># to sepreate jitter into their group.</span>
                                             dodge.width <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span>, 
             size <span class="op">=</span> <span class="fl">.3</span>, 
             alpha <span class="op">=</span> <span class="fl">.03</span>,
             show.legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.3</span>, 
               outlier.shape <span class="op">=</span> <span class="cn">NA</span>,
               alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, ncol <span class="op">=</span> <span class="fl">1</span>, scale <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, 
       y <span class="op">=</span> <span class="st">"Age"</span>,
       title <span class="op">=</span> <span class="st">"Raincloud plot of the age of clients, by their education and jobs"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Result of the call"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#56B4E9"</span>, <span class="st">"#E69F00"</span><span class="op">)</span>, na.value <span class="op">=</span> <span class="st">"#5f5f5f"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#56B4E9"</span>, <span class="st">"#E69F00"</span><span class="op">)</span>, na.value <span class="op">=</span> <span class="st">"#5f5f5f"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">breaks_width</span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_pubr</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span>, x.text.angle <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span>
  <span class="va">text_theme</span></code></pre></div>
<div class="inline-figure"><img src="raincloud_plot_tutorial_files/figure-html/unnamed-chunk-19-1.png" width="1440" style="display: block; margin: auto;"></div>
<p>Lots of interesting information in this graph, for example:</p>
<ul>
<li><p>For education: <code>basic.4y</code> seems to be the group that salesmen can earn more clients among elder people</p></li>
<li><p>For Job: younger students are more easily to become new client!</p></li>
<li><p>···</p></li>
</ul>
</div>
<div id="grouped-numerical-x-grouped-numerical-y" class="section level3">
<h3>
<span class="header-section-number">53.3.3</span> Grouped Numerical X + Grouped Numerical Y<a class="anchor" aria-label="anchor" href="#grouped-numerical-x-grouped-numerical-y"><i class="fas fa-link"></i></a>
</h3>
<p>Raincloud plots can also be utilized as two additional scatter plot subplots, one to the left of the y axis and one to the bottom of the x axis!</p>
<blockquote>
<p>I have this idea seeing some folks add box plot and density curve around the axes, like the “Add marginal plots” section from the <a href="http://www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/78-perfect-scatter-plots-with-correlation-and-marginal-histograms/">ggpubr tutorial</a>.</p>
</blockquote>
<p>Let use the <code>ames</code> in the <code>openintro</code> package used in the homework 2! First I divide the 1~10 <code>overall quality</code> variable into 3 groups:</p>
<div class="sourceCode" id="cb660"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ames</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span><span class="va">price</span>,
            Overall.Qual <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">Overall.Qual</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,
            <span class="va">area</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">ames_cutted</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ames_cutted</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##    price Overall.Qual  area
##    &lt;int&gt; &lt;fct&gt;        &lt;int&gt;
## 1 215000 (4,7]         1656
## 2 105000 (4,7]          896
## 3 172000 (4,7]         1329
## 4 244000 (4,7]         2110
## 5 189900 (4,7]         1629
## 6 195500 (4,7]         1604</code></pre>
<p>Then we generate 3 subplots are organize them by <code>patchwork</code> package.</p>
<div class="sourceCode" id="cb662"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">COLOR_TEMP</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#d5896f"</span>,<span class="st">"#dab785"</span>,<span class="st">"#70a288"</span><span class="op">)</span>
<span class="va">ames_cutted</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">price</span>, 
      x <span class="op">=</span> <span class="va">area</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Overall.Qual</span><span class="op">)</span>,
             size <span class="op">=</span> <span class="fl">.9</span>,
             alpha <span class="op">=</span> <span class="fl">0.25</span>,
             stroke <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"dashed"</span>,
              se <span class="op">=</span> <span class="cn">F</span>,
              color <span class="op">=</span> <span class="st">'darkgray'</span>,
              formula <span class="op">=</span> <span class="st">'y ~ x'</span>,
              method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Overall.Qual</span><span class="op">)</span>,
              formula <span class="op">=</span> <span class="st">'y ~ x'</span>,
              method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span>
  
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">axis_unit_scaler_1</span>, breaks <span class="op">=</span> <span class="fu">pretty_breaks</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">axis_unit_scaler_1</span>, breaks <span class="op">=</span> <span class="fu">pretty_breaks</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">COLOR_TEMP</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">COLOR_TEMP</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Area"</span>,
       y <span class="op">=</span> <span class="st">'Price'</span>,
       title <span class="op">=</span> <span class="st">'Scatter plot for the area and price of housing'</span><span class="op">)</span> <span class="op">+</span>
  <span class="va">theme_jace</span> <span class="op">+</span>
  <span class="fu">get_lightxy</span><span class="op">(</span><span class="fl">0.6</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">p_scatter</span>

<span class="va">ames_cutted</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
 
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">price</span>, 
      x <span class="op">=</span> <span class="va">Overall.Qual</span>,
      fill <span class="op">=</span> <span class="va">Overall.Qual</span><span class="op">)</span> <span class="op">+</span> <span class="co">#</span>
  <span class="fu">geom_flat_violin</span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span>, 
                   alpha <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Overall.Qual</span><span class="op">)</span>, 
             position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span>,
             size <span class="op">=</span> <span class="fl">.3</span>, 
             alpha <span class="op">=</span> <span class="fl">.5</span>,
             show.legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span>
  
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.3</span>, 
               outlier.shape <span class="op">=</span> <span class="cn">NA</span>,
               alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Overall Quality"</span>, y <span class="op">=</span> <span class="st">"Price"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">COLOR_TEMP</span>, guide<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">COLOR_TEMP</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">axis_unit_scaler_1</span>, breaks <span class="op">=</span> <span class="fu">pretty_breaks</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="va">theme_jace</span> <span class="op">-&gt;</span> <span class="va">p_price</span>

<span class="va">ames_cutted</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
 
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">area</span>, 
      x <span class="op">=</span> <span class="va">Overall.Qual</span>,
      fill <span class="op">=</span> <span class="va">Overall.Qual</span><span class="op">)</span> <span class="op">+</span> <span class="co">#</span>
  <span class="fu">geom_flat_violin</span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span>, 
                   alpha <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Overall.Qual</span><span class="op">)</span>, 
             position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span>,
             size <span class="op">=</span> <span class="fl">.3</span>, 
             alpha <span class="op">=</span> <span class="fl">.5</span>,
             show.legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.3</span>, 
               outlier.shape <span class="op">=</span> <span class="cn">NA</span>,
               alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Overall Quality"</span>, y <span class="op">=</span> <span class="st">"Area"</span>, fill <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">COLOR_TEMP</span>, guide<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">COLOR_TEMP</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">axis_unit_scaler_1</span>, breaks <span class="op">=</span> <span class="fu">pretty_breaks</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="va">theme_jace</span> <span class="op">+</span>
  <span class="va">only_x</span> <span class="op">-&gt;</span> <span class="va">p_area</span>


<span class="va">layout</span> <span class="op">=</span> <span class="st">"11333333333
          11333333333
          11333333333
          11333333333
          11333333333
          11333333333
          11333333333
          ##222222222
          ##222222222"</span>
      
<span class="va">p_price</span> <span class="op">+</span> <span class="va">p_area</span> <span class="op">+</span> <span class="va">p_scatter</span> <span class="op">+</span> 
  <span class="fu">plot_layout</span><span class="op">(</span>design <span class="op">=</span> <span class="va">layout</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"House Price vs Area in Ames"</span>,
       subtitle <span class="op">=</span> <span class="st">"group by the over quality binned into 3 classes"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="raincloud_plot_tutorial_files/figure-html/unnamed-chunk-21-1.png" width="1152" style="display: block; margin: auto;"></div>
<p>We can observe that the regression line is not as steep as the dashed line in the original figure after splitting houses into three categories. Lower quality houses not only have both house price and area distributed in a lower range (up to 3k in size and 270k in price), but they also have the slowest rate of house price growth along with area, implying the lowest average price per square meter.</p>
</div>
</div>
<div id="additional-tips" class="section level2">
<h2>
<span class="header-section-number">53.4</span> Additional Tips<a class="anchor" aria-label="anchor" href="#additional-tips"><i class="fas fa-link"></i></a>
</h2>
<p>Besides the adjustment mentioned inthe 2.4, these tips can also help you create a neat raincloud plot!</p>
<div id="use-a-theme-without-grid" class="section level3">
<h3>
<span class="header-section-number">53.4.1</span> Use a theme without grid<a class="anchor" aria-label="anchor" href="#use-a-theme-without-grid"><i class="fas fa-link"></i></a>
</h3>
<p>I customized a theme without grid base on <code>theme_clean()</code>! So to reproduce my cold, you can run this or simply remove the <code>+theme_jace</code>.</p>
<div class="sourceCode" id="cb663"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create my own theme: theme_jace</span>
<span class="va">FONT</span> <span class="op">=</span> <span class="st">"Times New Roman"</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">themebw_help</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
  text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="va">FONT</span>,
                      color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,
  plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face<span class="op">=</span><span class="st">"bold"</span>,
                            hjust <span class="op">=</span> <span class="fl">0.5</span>,
                            family <span class="op">=</span> <span class="va">FONT</span>,
                            colour <span class="op">=</span> <span class="st">"black"</span>,
                            margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">10</span>, r <span class="op">=</span> <span class="fl">0</span>, b <span class="op">=</span> <span class="fl">10</span>, l <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
                            size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>,
  axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="va">FONT</span>,
                           color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,
  plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="va">FONT</span>,
                               hjust <span class="op">=</span> <span class="fl">0.5</span>,
                               size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,
  axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,
  legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span>,
                              face <span class="op">=</span> <span class="st">"bold"</span>,
                              color <span class="op">=</span> <span class="st">"black"</span>,
                              family <span class="op">=</span> <span class="va">FONT</span><span class="op">)</span>,
  legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>,
                             color <span class="op">=</span> <span class="st">"black"</span>,
                             family <span class="op">=</span> <span class="va">FONT</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">text_theme</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
  panel.background <span class="op">=</span> <span class="va">themebw_help</span><span class="op">$</span><span class="va">panel.background</span>,
  strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">"lightgray"</span>, <span class="fl">0.5</span><span class="op">)</span>, inherit.blank <span class="op">=</span> <span class="cn">T</span>, colour <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,
  panel.border <span class="op">=</span> <span class="va">themebw_help</span><span class="op">$</span><span class="va">panel.border</span>,
  legend.background <span class="op">=</span> <span class="va">themebw_help</span><span class="op">$</span><span class="va">legend.background</span>,
  plot.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>,
  panel.grid.major.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">background_theme</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
  panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"transparent"</span>, colour <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>, <span class="co"># bg of the panel</span>
  plot.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"transparent"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>, <span class="co"># bg of the plot</span>
  panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>, <span class="co"># get rid of major grid</span>
  panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>, <span class="co"># get rid of minor grid</span>
  panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
  legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span>, <span class="co"># get rid of legend bg</span>
  legend.box.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span> <span class="co"># get rid of legend panel bg</span>
<span class="op">)</span> <span class="op">-&gt;</span> <span class="va">empty_theme</span>

<span class="va">theme_legend</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
  legend.box.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span>,
  legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,
  legend.box.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu">theme_clean</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="va">text_theme</span> <span class="op">+</span> <span class="va">background_theme</span> <span class="op">+</span> <span class="va">empty_theme</span> <span class="op">+</span> <span class="va">theme_legend</span>  <span class="op">-&gt;</span> <span class="va">theme_jace</span></code></pre></div>
</div>
<div id="adjust-the-axis" class="section level3">
<h3>
<span class="header-section-number">53.4.2</span> Adjust the axis<a class="anchor" aria-label="anchor" href="#adjust-the-axis"><i class="fas fa-link"></i></a>
</h3>
<p>To quickly read the value from boxplots’ statsitics, density curves’ modality, or the dots concentrated from the raincloud, I often do this:</p>
<ul>
<li>
<ol style="list-style-type: decimal">
<li>Disable minor lines that can not be labeled, and only keep x’s major lines:</li>
</ol>
<div class="sourceCode" id="cb664"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">only_x</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
  panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"lightgray"</span><span class="op">)</span>,
  panel.grid.major.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
  panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Then I add simply <code>+ only_x</code> to the plot!</p>
</li>
<li>
<ol start="2" style="list-style-type: decimal">
<li>Add more <code>breaks</code> in <code>scale_y_continuous</code> to add the amount of labeled ticks. <code>scales</code> pacakage allowds you to:</li>
</ol>
<ul>
<li><p><code>breaks = breaks_width(5000)</code>: breaks every 5000.</p></li>
<li><p><code>breaks = pretty_breaks(10)</code>: breaks them into about 10 ticks.</p></li>
</ul>
</li>
<li><ol start="3" style="list-style-type: decimal">
<li>For axes with large values, I will turn of the scitific notation by <code>options(scipen = 999)</code>. Then I shorten the ticks by plugging this function:</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb665"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">axis_unit_scaler</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">digits</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span>
  <span class="va">addUnits_leq_0</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
    <span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html">ifelse</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&lt;</span> <span class="fl">1000</span>, <span class="va">n</span>,  <span class="co"># less than thousands</span>
                       <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html">ifelse</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&lt;</span> <span class="fl">1e6</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">1e3</span>, digits <span class="op">=</span> <span class="va">digits</span><span class="op">)</span>, <span class="st">'k'</span><span class="op">)</span>,  <span class="co"># in thousands</span>
                              <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html">ifelse</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&lt;</span> <span class="fl">1e9</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">1e6</span>, digits <span class="op">=</span> <span class="va">digits</span><span class="op">)</span>, <span class="st">'M'</span><span class="op">)</span>,  <span class="co"># in millions</span>
                                     <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html">ifelse</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&lt;</span> <span class="fl">1e12</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">1e9</span>, digits <span class="op">=</span> <span class="va">digits</span><span class="op">)</span>, <span class="st">'B'</span><span class="op">)</span>, <span class="co"># in billions</span>
                                            <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html">ifelse</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&lt;</span> <span class="fl">1e15</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">1e12</span>, digits <span class="op">=</span> <span class="va">digits</span><span class="op">)</span>, <span class="st">'T'</span><span class="op">)</span>, <span class="co"># in trillions</span>
                                                   <span class="st">'too big!'</span>
                                            <span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>
  
  <span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html">ifelse</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&lt;</span> <span class="fl">0</span>, 
                   <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"-"</span>, <span class="fu">addUnits_leq_0</span><span class="op">(</span><span class="op">-</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># less than thousands</span>
                   <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html">ifelse</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;=</span> <span class="fl">0</span>, <span class="fu">addUnits_leq_0</span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,  
                          <span class="st">"NA"</span><span class="op">)</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">labels</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"12,345 now bocomes"</span>, <span class="fu">axis_unit_scaler</span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span>,
    <span class="st">"6,666,666 now becomes"</span>, <span class="fu">axis_unit_scaler</span><span class="op">(</span><span class="fl">6666666</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## 12,345 now bocomes 12.3k 6,666,666 now becomes 6.7M</code></pre>
<p>, and put it into <code>scale_y_continuous</code> like <code>p + scale_y_continuous(labels = axis_unit_scaler, breaks = pretty_breaks(10))</code></p>
</div>
</div>
<div id="reference-2" class="section level2">
<h2>
<span class="header-section-number">53.5</span> Reference<a class="anchor" aria-label="anchor" href="#reference-2"><i class="fas fa-link"></i></a>
</h2>
<p>Thank you for taking the time to read this lengthy tutorial! Hope you enjoy this. Now, if you</p>
<ul>
<li>
<p>want to know who are the geniuses that invented raincloud plot: <a href="https://peerj.com/preprints/27137/">Raincloud plots: a multi-platform tool for robust data visualization</a></p>
<ul>
<li>Their official tutorial in R, matlab, and python: <a href="https://github.com/RainCloudPlots/RainCloudPlots">Github</a>. (This is where I learned this fantastic technique in the first place!)</li>
</ul>
</li>
<li><p>want to know other ways to create it in R: <a href="https://www.business-science.io/r/2021/07/22/ggdist-raincloud-plots.html">ggdist</a></p></li>
<li><p>want to know how to create rain cloud plot in <strong>python</strong>: <a href="https://towardsdatascience.com/making-it-rain-with-raincloud-plots-496c39a2756f">Making it Rain with Raincloud Plots</a></p></li>
<li><p>know a better way to do it (or intended to build one): please email me at <a href="mailto:jy3174@columbia.edu" class="email">jy3174@columbia.edu</a>!</p></li>
</ul>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="comparison-among-base-r-tidyverse-and-datatable.html"><span class="header-section-number">52</span> Comparison among base R, tidyverse, and datatable</a></div>
<div class="next"><a href="an-introduction-to-dygraph-in-r.html"><span class="header-section-number">54</span> An Introduction to Dygraph in R</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#raincloud-plot-101-density-plot-or-boxplotwhy-not-do-both"><span class="header-section-number">53</span> Raincloud plot 101: density plot or boxplot？Why not do both!</a></li>
<li><a class="nav-link" href="#introduction-7"><span class="header-section-number">53.1</span> Introduction</a></li>
<li>
<a class="nav-link" href="#components-of-raincloud-plot."><span class="header-section-number">53.2</span> Components of raincloud plot.</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#tailoring-out-the-cloud-halved-violin"><span class="header-section-number">53.2.1</span> Tailoring out the cloud: halved violin</a></li>
<li><a class="nav-link" href="#making-it-rain-jittered-points"><span class="header-section-number">53.2.2</span> Making it rain: jittered points</a></li>
<li><a class="nav-link" href="#adding-the-box-to-collect-the-rain-boxplot"><span class="header-section-number">53.2.3</span> Adding the box to “collect” the rain: boxplot</a></li>
<li><a class="nav-link" href="#adjustment"><span class="header-section-number">53.2.4</span> Adjustment</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#more-examples"><span class="header-section-number">53.3</span> More Examples</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#grouped-categorical-x-numerical-y"><span class="header-section-number">53.3.1</span> Grouped Categorical X + Numerical Y</a></li>
<li><a class="nav-link" href="#categorical-x1-numerical-x2-numerical-y"><span class="header-section-number">53.3.2</span> Categorical X1 + Numerical X2 + Numerical Y</a></li>
<li><a class="nav-link" href="#grouped-numerical-x-grouped-numerical-y"><span class="header-section-number">53.3.3</span> Grouped Numerical X + Grouped Numerical Y</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#additional-tips"><span class="header-section-number">53.4</span> Additional Tips</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#use-a-theme-without-grid"><span class="header-section-number">53.4.1</span> Use a theme without grid</a></li>
<li><a class="nav-link" href="#adjust-the-axis"><span class="header-section-number">53.4.2</span> Adjust the axis</a></li>
</ul>
</li>
<li><a class="nav-link" href="#reference-2"><span class="header-section-number">53.5</span> Reference</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/jtr13/cc21fall2/blob/main/raincloud_plot_tutorial.rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/jtr13/cc21fall2/edit/main/raincloud_plot_tutorial.rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>EDAV Fall 2021 Tues/Thurs Community Contributions</strong>" was written by . It was last built on 2021-11-19.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
